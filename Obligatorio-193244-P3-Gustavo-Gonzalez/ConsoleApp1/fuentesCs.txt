***********************************
Archivo: EmpresaContexto.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\LogicaAccesoDatos\EmpresaContexto.cs
***********************************
using LogicaNegocio.EntidadesNegocio;
using Microsoft.EntityFrameworkCore;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace LogicaAccesoDatos
{
    public class EmpresaContexto:DbContext
    {
        public EmpresaContexto(DbContextOptions options) : base(options){}

        public DbSet<TipoGasto> TiposGastos {  get; set; }
        public DbSet<Usuario> Usuarios { get; set; }
        public DbSet<Rol> Roles { get; set; }
        public DbSet<Auditoria> Auditorias { get; set; }
        public DbSet<Pago> Pagos { get; set; }
        public DbSet<PagoUnico> PagoUnicos { get; set; }
        public DbSet<PagoRecurrente> PagoRecurrentes { get; set; }
        public DbSet<MetodoPago> MetodoPagos { get; set; }
        public DbSet<Equipo> Equipos { get; set; }

        protected override void OnModelCreating(ModelBuilder modelBuilder)
        {
            //modelBuilder.Entity<Pago>().HasOne(p => p.TipoGasto).WithMany().OnDelete(DeleteBehavior.NoAction);
            //modelBuilder.Entity<Pago>().HasOne(p => p.Usuario).WithMany().OnDelete(DeleteBehavior.NoAction);
            //modelBuilder.Entity<Pago>().HasOne(p => p.MetodoPago).WithMany().OnDelete(DeleteBehavior.NoAction);

            base.OnModelCreating(modelBuilder);
        }


    }
}

***********************************
Archivo: WeatherForecast.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\WebAPI\WeatherForecast.cs
***********************************
namespace WebAPI
{
    public class WeatherForecast
    {
        public DateOnly Date { get; set; }

        public int TemperatureC { get; set; }

        public int TemperatureF => 32 + (int)(TemperatureC / 0.5556);

        public string? Summary { get; set; }
    }
}

***********************************
Archivo: AuditoriaException.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\ExcepcionesPropias\ExcepcionesEntidades\AuditoriaException.cs
***********************************
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace ExcepcionesPropias.ExcepcionesEntidades
{
    public class AuditoriaException:Exception
    {
        public AuditoriaException() { }
        public AuditoriaException(string message) : base(message) { }
        public AuditoriaException(string? message, Exception innerException) : base(message, innerException){ }
    }
}

***********************************
Archivo: EquipoException.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\ExcepcionesPropias\ExcepcionesEntidades\EquipoException.cs
***********************************
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace ExcepcionesPropias.ExcepcionesEntidades
{
    public class EquipoException:Exception
    {
        public EquipoException() { }
        public EquipoException(string message) : base(message) { }
        public EquipoException(string? message, Exception innerException) : base(message, innerException) { }
    }
}

***********************************
Archivo: GastoException.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\ExcepcionesPropias\ExcepcionesEntidades\GastoException.cs
***********************************
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace ExcepcionesPropias.ExcepcionesEntidades
{
    public class GastoException : Exception
    {
        public GastoException() { }
        public GastoException(string message) : base(message) { }
        public GastoException(string message, Exception? innerException) : base(message, innerException){ }
    }
}

***********************************
Archivo: MetodoPagoException.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\ExcepcionesPropias\ExcepcionesEntidades\MetodoPagoException.cs
***********************************
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace ExcepcionesPropias.ExcepcionesEntidades
{
    public class MetodoPagoException:Exception
    {
        public MetodoPagoException() { }
        public MetodoPagoException(string message) : base(message) { }
        public MetodoPagoException(string message, Exception? innerException) : base(message, innerException) { }
    }
}

***********************************
Archivo: PagoException.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\ExcepcionesPropias\ExcepcionesEntidades\PagoException.cs
***********************************
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace ExcepcionesPropias.ExcepcionesEntidades
{
    public class PagoException:Exception
    {
        public PagoException() { }
        public PagoException(string message) : base(message) { }
        public PagoException(string message, Exception? innerException) : base(message, innerException){}
    }
}

***********************************
Archivo: RolException.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\ExcepcionesPropias\ExcepcionesEntidades\RolException.cs
***********************************
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace ExcepcionesPropias.ExcepcionesEntidades
{
    public class RolException:Exception
    {
        public RolException() { }
        public RolException(string message) : base(message) { }
        public RolException(string? message, Exception innerException) : base(message, innerException) { }
    }
}

***********************************
Archivo: UsuarioException.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\ExcepcionesPropias\ExcepcionesEntidades\UsuarioException.cs
***********************************
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace ExcepcionesPropias.ExcepcionesEntidades
{
    public class UsuarioException:Exception
    {
        public UsuarioException() { }
        public UsuarioException(string message) : base(message) { }
        public UsuarioException(string message, Exception? innerException) : base(message, innerException) { }
    }
}

***********************************
Archivo: 20251017184724_init.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\LogicaAccesoDatos\Migrations\20251017184724_init.cs
***********************************
using System;
using Microsoft.EntityFrameworkCore.Migrations;

#nullable disable

namespace LogicaAccesoDatos.Migrations
{
    /// <inheritdoc />
    public partial class init : Migration
    {
        /// <inheritdoc />
        protected override void Up(MigrationBuilder migrationBuilder)
        {
            migrationBuilder.CreateTable(
                name: "Auditorias",
                columns: table => new
                {
                    Id = table.Column<int>(type: "int", nullable: false)
                        .Annotation("SqlServer:Identity", "1, 1"),
                    Accion = table.Column<string>(type: "nvarchar(max)", nullable: false),
                    FechaUtc = table.Column<DateTime>(type: "datetime2", nullable: false),
                    UsuarioId = table.Column<int>(type: "int", nullable: false),
                    NombreUsuario = table.Column<string>(type: "nvarchar(max)", nullable: false),
                    TipoGastoNombre = table.Column<string>(type: "nvarchar(max)", nullable: false),
                    TipoGastoDesc = table.Column<string>(type: "nvarchar(max)", nullable: false)
                },
                constraints: table =>
                {
                    table.PrimaryKey("PK_Auditorias", x => x.Id);
                });

            migrationBuilder.CreateTable(
                name: "Equipos",
                columns: table => new
                {
                    Id = table.Column<int>(type: "int", nullable: false)
                        .Annotation("SqlServer:Identity", "1, 1"),
                    Nombre = table.Column<string>(type: "nvarchar(450)", nullable: false)
                },
                constraints: table =>
                {
                    table.PrimaryKey("PK_Equipos", x => x.Id);
                });

            migrationBuilder.CreateTable(
                name: "MetodoPagos",
                columns: table => new
                {
                    Id = table.Column<int>(type: "int", nullable: false)
                        .Annotation("SqlServer:Identity", "1, 1"),
                    Descripcion = table.Column<string>(type: "nvarchar(max)", nullable: false)
                },
                constraints: table =>
                {
                    table.PrimaryKey("PK_MetodoPagos", x => x.Id);
                });

            migrationBuilder.CreateTable(
                name: "Roles",
                columns: table => new
                {
                    Id = table.Column<int>(type: "int", nullable: false)
                        .Annotation("SqlServer:Identity", "1, 1"),
                    Nombre = table.Column<string>(type: "nvarchar(max)", nullable: false)
                },
                constraints: table =>
                {
                    table.PrimaryKey("PK_Roles", x => x.Id);
                });

            migrationBuilder.CreateTable(
                name: "TiposGastos",
                columns: table => new
                {
                    Id = table.Column<int>(type: "int", nullable: false)
                        .Annotation("SqlServer:Identity", "1, 1"),
                    Nombre = table.Column<string>(type: "nvarchar(450)", nullable: false),
                    Descripcion = table.Column<string>(type: "nvarchar(max)", nullable: false)
                },
                constraints: table =>
                {
                    table.PrimaryKey("PK_TiposGastos", x => x.Id);
                });

            migrationBuilder.CreateTable(
                name: "Usuarios",
                columns: table => new
                {
                    Id = table.Column<int>(type: "int", nullable: false)
                        .Annotation("SqlServer:Identity", "1, 1"),
                    Nombre = table.Column<string>(type: "nvarchar(max)", nullable: false),
                    Apellido = table.Column<string>(type: "nvarchar(max)", nullable: false),
                    Password = table.Column<string>(type: "nvarchar(max)", nullable: false),
                    Mail = table.Column<string>(type: "nvarchar(450)", nullable: false),
                    RolId = table.Column<int>(type: "int", nullable: false),
                    EquipoId = table.Column<int>(type: "int", nullable: false)
                },
                constraints: table =>
                {
                    table.PrimaryKey("PK_Usuarios", x => x.Id);
                    table.ForeignKey(
                        name: "FK_Usuarios_Equipos_EquipoId",
                        column: x => x.EquipoId,
                        principalTable: "Equipos",
                        principalColumn: "Id",
                        onDelete: ReferentialAction.Cascade);
                    table.ForeignKey(
                        name: "FK_Usuarios_Roles_RolId",
                        column: x => x.RolId,
                        principalTable: "Roles",
                        principalColumn: "Id",
                        onDelete: ReferentialAction.Cascade);
                });

            migrationBuilder.CreateTable(
                name: "Pagos",
                columns: table => new
                {
                    Id = table.Column<int>(type: "int", nullable: false)
                        .Annotation("SqlServer:Identity", "1, 1"),
                    MetodoPagoId = table.Column<int>(type: "int", nullable: false),
                    TipoGastoId = table.Column<int>(type: "int", nullable: false),
                    UsuarioId = table.Column<int>(type: "int", nullable: false),
                    Descripcion = table.Column<string>(type: "nvarchar(max)", nullable: false),
                    Discriminator = table.Column<string>(type: "nvarchar(21)", maxLength: 21, nullable: false),
                    FechaDesde = table.Column<DateTime>(type: "datetime2", nullable: true),
                    FechaHasta = table.Column<DateTime>(type: "datetime2", nullable: true),
                    ValorCompra = table.Column<decimal>(type: "decimal(18,2)", nullable: true),
                    NumeroRecibo = table.Column<int>(type: "int", nullable: true),
                    FechaPago = table.Column<DateTime>(type: "datetime2", nullable: true),
                    MontoPago = table.Column<decimal>(type: "decimal(18,2)", nullable: true)
                },
                constraints: table =>
                {
                    table.PrimaryKey("PK_Pagos", x => x.Id);
                    table.ForeignKey(
                        name: "FK_Pagos_MetodoPagos_MetodoPagoId",
                        column: x => x.MetodoPagoId,
                        principalTable: "MetodoPagos",
                        principalColumn: "Id",
                        onDelete: ReferentialAction.Cascade);
                    table.ForeignKey(
                        name: "FK_Pagos_TiposGastos_TipoGastoId",
                        column: x => x.TipoGastoId,
                        principalTable: "TiposGastos",
                        principalColumn: "Id",
                        onDelete: ReferentialAction.Cascade);
                    table.ForeignKey(
                        name: "FK_Pagos_Usuarios_UsuarioId",
                        column: x => x.UsuarioId,
                        principalTable: "Usuarios",
                        principalColumn: "Id",
                        onDelete: ReferentialAction.Cascade);
                });

            migrationBuilder.CreateIndex(
                name: "IX_Equipos_Nombre",
                table: "Equipos",
                column: "Nombre",
                unique: true);

            migrationBuilder.CreateIndex(
                name: "IX_Pagos_MetodoPagoId",
                table: "Pagos",
                column: "MetodoPagoId");

            migrationBuilder.CreateIndex(
                name: "IX_Pagos_TipoGastoId",
                table: "Pagos",
                column: "TipoGastoId");

            migrationBuilder.CreateIndex(
                name: "IX_Pagos_UsuarioId",
                table: "Pagos",
                column: "UsuarioId");

            migrationBuilder.CreateIndex(
                name: "UX_TipoGasto_Nombre",
                table: "TiposGastos",
                column: "Nombre",
                unique: true);

            migrationBuilder.CreateIndex(
                name: "IX_Usuarios_EquipoId",
                table: "Usuarios",
                column: "EquipoId");

            migrationBuilder.CreateIndex(
                name: "IX_Usuarios_Mail",
                table: "Usuarios",
                column: "Mail",
                unique: true);

            migrationBuilder.CreateIndex(
                name: "IX_Usuarios_RolId",
                table: "Usuarios",
                column: "RolId");
        }

        /// <inheritdoc />
        protected override void Down(MigrationBuilder migrationBuilder)
        {
            migrationBuilder.DropTable(
                name: "Auditorias");

            migrationBuilder.DropTable(
                name: "Pagos");

            migrationBuilder.DropTable(
                name: "MetodoPagos");

            migrationBuilder.DropTable(
                name: "TiposGastos");

            migrationBuilder.DropTable(
                name: "Usuarios");

            migrationBuilder.DropTable(
                name: "Equipos");

            migrationBuilder.DropTable(
                name: "Roles");
        }
    }
}

***********************************
Archivo: 20251017184724_init.Designer.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\LogicaAccesoDatos\Migrations\20251017184724_init.Designer.cs
***********************************
// <auto-generated />
using System;
using LogicaAccesoDatos;
using Microsoft.EntityFrameworkCore;
using Microsoft.EntityFrameworkCore.Infrastructure;
using Microsoft.EntityFrameworkCore.Metadata;
using Microsoft.EntityFrameworkCore.Migrations;
using Microsoft.EntityFrameworkCore.Storage.ValueConversion;

#nullable disable

namespace LogicaAccesoDatos.Migrations
{
    [DbContext(typeof(EmpresaContexto))]
    [Migration("20251017184724_init")]
    partial class init
    {
        /// <inheritdoc />
        protected override void BuildTargetModel(ModelBuilder modelBuilder)
        {
#pragma warning disable 612, 618
            modelBuilder
                .HasAnnotation("ProductVersion", "8.0.19")
                .HasAnnotation("Relational:MaxIdentifierLength", 128);

            SqlServerModelBuilderExtensions.UseIdentityColumns(modelBuilder);

            modelBuilder.Entity("LogicaNegocio.EntidadesNegocio.Auditoria", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<string>("Accion")
                        .IsRequired()
                        .HasColumnType("nvarchar(max)");

                    b.Property<DateTime>("FechaUtc")
                        .HasColumnType("datetime2");

                    b.Property<string>("NombreUsuario")
                        .IsRequired()
                        .HasColumnType("nvarchar(max)");

                    b.Property<string>("TipoGastoDesc")
                        .IsRequired()
                        .HasColumnType("nvarchar(max)");

                    b.Property<string>("TipoGastoNombre")
                        .IsRequired()
                        .HasColumnType("nvarchar(max)");

                    b.Property<int>("UsuarioId")
                        .HasColumnType("int");

                    b.HasKey("Id");

                    b.ToTable("Auditorias");
                });

            modelBuilder.Entity("LogicaNegocio.EntidadesNegocio.Equipo", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<string>("Nombre")
                        .IsRequired()
                        .HasColumnType("nvarchar(450)");

                    b.HasKey("Id");

                    b.HasIndex("Nombre")
                        .IsUnique();

                    b.ToTable("Equipos");
                });

            modelBuilder.Entity("LogicaNegocio.EntidadesNegocio.MetodoPago", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<string>("Descripcion")
                        .IsRequired()
                        .HasColumnType("nvarchar(max)");

                    b.HasKey("Id");

                    b.ToTable("MetodoPagos");
                });

            modelBuilder.Entity("LogicaNegocio.EntidadesNegocio.Pago", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<string>("Descripcion")
                        .IsRequired()
                        .HasColumnType("nvarchar(max)");

                    b.Property<string>("Discriminator")
                        .IsRequired()
                        .HasMaxLength(21)
                        .HasColumnType("nvarchar(21)");

                    b.Property<int>("MetodoPagoId")
                        .HasColumnType("int");

                    b.Property<int>("TipoGastoId")
                        .HasColumnType("int");

                    b.Property<int>("UsuarioId")
                        .HasColumnType("int");

                    b.HasKey("Id");

                    b.HasIndex("MetodoPagoId");

                    b.HasIndex("TipoGastoId");

                    b.HasIndex("UsuarioId");

                    b.ToTable("Pagos");

                    b.HasDiscriminator().HasValue("Pago");

                    b.UseTphMappingStrategy();
                });

            modelBuilder.Entity("LogicaNegocio.EntidadesNegocio.Rol", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<string>("Nombre")
                        .IsRequired()
                        .HasColumnType("nvarchar(max)");

                    b.HasKey("Id");

                    b.ToTable("Roles");
                });

            modelBuilder.Entity("LogicaNegocio.EntidadesNegocio.TipoGasto", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<string>("Descripcion")
                        .IsRequired()
                        .HasColumnType("nvarchar(max)");

                    b.Property<string>("Nombre")
                        .IsRequired()
                        .HasColumnType("nvarchar(450)");

                    b.HasKey("Id");

                    b.HasIndex(new[] { "Nombre" }, "UX_TipoGasto_Nombre")
                        .IsUnique();

                    b.ToTable("TiposGastos");
                });

            modelBuilder.Entity("LogicaNegocio.EntidadesNegocio.Usuario", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<string>("Apellido")
                        .IsRequired()
                        .HasColumnType("nvarchar(max)");

                    b.Property<int>("EquipoId")
                        .HasColumnType("int");

                    b.Property<string>("Mail")
                        .IsRequired()
                        .HasColumnType("nvarchar(450)");

                    b.Property<string>("Nombre")
                        .IsRequired()
                        .HasColumnType("nvarchar(max)");

                    b.Property<string>("Password")
                        .IsRequired()
                        .HasColumnType("nvarchar(max)");

                    b.Property<int>("RolId")
                        .HasColumnType("int");

                    b.HasKey("Id");

                    b.HasIndex("EquipoId");

                    b.HasIndex("Mail")
                        .IsUnique();

                    b.HasIndex("RolId");

                    b.ToTable("Usuarios");
                });

            modelBuilder.Entity("LogicaNegocio.EntidadesNegocio.PagoRecurrente", b =>
                {
                    b.HasBaseType("LogicaNegocio.EntidadesNegocio.Pago");

                    b.Property<DateTime>("FechaDesde")
                        .HasColumnType("datetime2");

                    b.Property<DateTime>("FechaHasta")
                        .HasColumnType("datetime2");

                    b.Property<decimal?>("ValorCompra")
                        .HasColumnType("decimal(18,2)");

                    b.HasDiscriminator().HasValue("PagoRecurrente");
                });

            modelBuilder.Entity("LogicaNegocio.EntidadesNegocio.PagoUnico", b =>
                {
                    b.HasBaseType("LogicaNegocio.EntidadesNegocio.Pago");

                    b.Property<DateTime?>("FechaPago")
                        .HasColumnType("datetime2");

                    b.Property<decimal?>("MontoPago")
                        .HasColumnType("decimal(18,2)");

                    b.Property<int?>("NumeroRecibo")
                        .HasColumnType("int");

                    b.HasDiscriminator().HasValue("PagoUnico");
                });

            modelBuilder.Entity("LogicaNegocio.EntidadesNegocio.Pago", b =>
                {
                    b.HasOne("LogicaNegocio.EntidadesNegocio.MetodoPago", "MetodoPago")
                        .WithMany()
                        .HasForeignKey("MetodoPagoId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.HasOne("LogicaNegocio.EntidadesNegocio.TipoGasto", "TipoGasto")
                        .WithMany()
                        .HasForeignKey("TipoGastoId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.HasOne("LogicaNegocio.EntidadesNegocio.Usuario", "Usuario")
                        .WithMany()
                        .HasForeignKey("UsuarioId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.Navigation("MetodoPago");

                    b.Navigation("TipoGasto");

                    b.Navigation("Usuario");
                });

            modelBuilder.Entity("LogicaNegocio.EntidadesNegocio.Usuario", b =>
                {
                    b.HasOne("LogicaNegocio.EntidadesNegocio.Equipo", "Equipo")
                        .WithMany()
                        .HasForeignKey("EquipoId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.HasOne("LogicaNegocio.EntidadesNegocio.Rol", "Rol")
                        .WithMany()
                        .HasForeignKey("RolId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.Navigation("Equipo");

                    b.Navigation("Rol");
                });
#pragma warning restore 612, 618
        }
    }
}

***********************************
Archivo: EmpresaContextoModelSnapshot.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\LogicaAccesoDatos\Migrations\EmpresaContextoModelSnapshot.cs
***********************************
// <auto-generated />
using System;
using LogicaAccesoDatos;
using Microsoft.EntityFrameworkCore;
using Microsoft.EntityFrameworkCore.Infrastructure;
using Microsoft.EntityFrameworkCore.Metadata;
using Microsoft.EntityFrameworkCore.Storage.ValueConversion;

#nullable disable

namespace LogicaAccesoDatos.Migrations
{
    [DbContext(typeof(EmpresaContexto))]
    partial class EmpresaContextoModelSnapshot : ModelSnapshot
    {
        protected override void BuildModel(ModelBuilder modelBuilder)
        {
#pragma warning disable 612, 618
            modelBuilder
                .HasAnnotation("ProductVersion", "8.0.19")
                .HasAnnotation("Relational:MaxIdentifierLength", 128);

            SqlServerModelBuilderExtensions.UseIdentityColumns(modelBuilder);

            modelBuilder.Entity("LogicaNegocio.EntidadesNegocio.Auditoria", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<string>("Accion")
                        .IsRequired()
                        .HasColumnType("nvarchar(max)");

                    b.Property<DateTime>("FechaUtc")
                        .HasColumnType("datetime2");

                    b.Property<string>("NombreUsuario")
                        .IsRequired()
                        .HasColumnType("nvarchar(max)");

                    b.Property<string>("TipoGastoDesc")
                        .IsRequired()
                        .HasColumnType("nvarchar(max)");

                    b.Property<string>("TipoGastoNombre")
                        .IsRequired()
                        .HasColumnType("nvarchar(max)");

                    b.Property<int>("UsuarioId")
                        .HasColumnType("int");

                    b.HasKey("Id");

                    b.ToTable("Auditorias");
                });

            modelBuilder.Entity("LogicaNegocio.EntidadesNegocio.Equipo", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<string>("Nombre")
                        .IsRequired()
                        .HasColumnType("nvarchar(450)");

                    b.HasKey("Id");

                    b.HasIndex("Nombre")
                        .IsUnique();

                    b.ToTable("Equipos");
                });

            modelBuilder.Entity("LogicaNegocio.EntidadesNegocio.MetodoPago", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<string>("Descripcion")
                        .IsRequired()
                        .HasColumnType("nvarchar(max)");

                    b.HasKey("Id");

                    b.ToTable("MetodoPagos");
                });

            modelBuilder.Entity("LogicaNegocio.EntidadesNegocio.Pago", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<string>("Descripcion")
                        .IsRequired()
                        .HasColumnType("nvarchar(max)");

                    b.Property<string>("Discriminator")
                        .IsRequired()
                        .HasMaxLength(21)
                        .HasColumnType("nvarchar(21)");

                    b.Property<int>("MetodoPagoId")
                        .HasColumnType("int");

                    b.Property<int>("TipoGastoId")
                        .HasColumnType("int");

                    b.Property<int>("UsuarioId")
                        .HasColumnType("int");

                    b.HasKey("Id");

                    b.HasIndex("MetodoPagoId");

                    b.HasIndex("TipoGastoId");

                    b.HasIndex("UsuarioId");

                    b.ToTable("Pagos");

                    b.HasDiscriminator().HasValue("Pago");

                    b.UseTphMappingStrategy();
                });

            modelBuilder.Entity("LogicaNegocio.EntidadesNegocio.Rol", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<string>("Nombre")
                        .IsRequired()
                        .HasColumnType("nvarchar(max)");

                    b.HasKey("Id");

                    b.ToTable("Roles");
                });

            modelBuilder.Entity("LogicaNegocio.EntidadesNegocio.TipoGasto", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<string>("Descripcion")
                        .IsRequired()
                        .HasColumnType("nvarchar(max)");

                    b.Property<string>("Nombre")
                        .IsRequired()
                        .HasColumnType("nvarchar(450)");

                    b.HasKey("Id");

                    b.HasIndex(new[] { "Nombre" }, "UX_TipoGasto_Nombre")
                        .IsUnique();

                    b.ToTable("TiposGastos");
                });

            modelBuilder.Entity("LogicaNegocio.EntidadesNegocio.Usuario", b =>
                {
                    b.Property<int>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("int");

                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"));

                    b.Property<string>("Apellido")
                        .IsRequired()
                        .HasColumnType("nvarchar(max)");

                    b.Property<int>("EquipoId")
                        .HasColumnType("int");

                    b.Property<string>("Mail")
                        .IsRequired()
                        .HasColumnType("nvarchar(450)");

                    b.Property<string>("Nombre")
                        .IsRequired()
                        .HasColumnType("nvarchar(max)");

                    b.Property<string>("Password")
                        .IsRequired()
                        .HasColumnType("nvarchar(max)");

                    b.Property<int>("RolId")
                        .HasColumnType("int");

                    b.HasKey("Id");

                    b.HasIndex("EquipoId");

                    b.HasIndex("Mail")
                        .IsUnique();

                    b.HasIndex("RolId");

                    b.ToTable("Usuarios");
                });

            modelBuilder.Entity("LogicaNegocio.EntidadesNegocio.PagoRecurrente", b =>
                {
                    b.HasBaseType("LogicaNegocio.EntidadesNegocio.Pago");

                    b.Property<DateTime>("FechaDesde")
                        .HasColumnType("datetime2");

                    b.Property<DateTime>("FechaHasta")
                        .HasColumnType("datetime2");

                    b.Property<decimal?>("ValorCompra")
                        .HasColumnType("decimal(18,2)");

                    b.HasDiscriminator().HasValue("PagoRecurrente");
                });

            modelBuilder.Entity("LogicaNegocio.EntidadesNegocio.PagoUnico", b =>
                {
                    b.HasBaseType("LogicaNegocio.EntidadesNegocio.Pago");

                    b.Property<DateTime?>("FechaPago")
                        .HasColumnType("datetime2");

                    b.Property<decimal?>("MontoPago")
                        .HasColumnType("decimal(18,2)");

                    b.Property<int?>("NumeroRecibo")
                        .HasColumnType("int");

                    b.HasDiscriminator().HasValue("PagoUnico");
                });

            modelBuilder.Entity("LogicaNegocio.EntidadesNegocio.Pago", b =>
                {
                    b.HasOne("LogicaNegocio.EntidadesNegocio.MetodoPago", "MetodoPago")
                        .WithMany()
                        .HasForeignKey("MetodoPagoId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.HasOne("LogicaNegocio.EntidadesNegocio.TipoGasto", "TipoGasto")
                        .WithMany()
                        .HasForeignKey("TipoGastoId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.HasOne("LogicaNegocio.EntidadesNegocio.Usuario", "Usuario")
                        .WithMany()
                        .HasForeignKey("UsuarioId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.Navigation("MetodoPago");

                    b.Navigation("TipoGasto");

                    b.Navigation("Usuario");
                });

            modelBuilder.Entity("LogicaNegocio.EntidadesNegocio.Usuario", b =>
                {
                    b.HasOne("LogicaNegocio.EntidadesNegocio.Equipo", "Equipo")
                        .WithMany()
                        .HasForeignKey("EquipoId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.HasOne("LogicaNegocio.EntidadesNegocio.Rol", "Rol")
                        .WithMany()
                        .HasForeignKey("RolId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();

                    b.Navigation("Equipo");

                    b.Navigation("Rol");
                });
#pragma warning restore 612, 618
        }
    }
}

***********************************
Archivo: RepositorioAuditoria.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\LogicaAccesoDatos\Repositorios\RepositorioAuditoria.cs
***********************************
using LogicaNegocio.EntidadesNegocio;
using LogicaNegocio.InterfacesRepositorio;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace LogicaAccesoDatos.Repositorios
{
    public class RepositorioAuditoria : IRepositorioAuditoria
    {
        public EmpresaContexto Contexto { get; set; }
        public RepositorioAuditoria(EmpresaContexto contexto)
        {
            Contexto = contexto;
        }

        public void Add(Auditoria item)
        {
            item.Validar();
            Contexto.Add(item);
            Contexto.SaveChanges();
        }

        public void Update(Auditoria item)
        {
            throw new NotImplementedException();
        }

        public void Delete(Auditoria item)
        {
            throw new NotImplementedException();
        }

        public Auditoria FindById(int id)
        {
            throw new NotImplementedException();
        }

        public IEnumerable<Auditoria> FindAll()
        {
            throw new NotImplementedException();
        }

        public Auditoria FindByMail(string mail)
        {
            throw new NotImplementedException();
        }

        public Auditoria UsuarioPorMailYPass(string mail, string pass)
        {
            throw new NotImplementedException();
        }

        public Auditoria FindByName(string name)
        {
            throw new NotImplementedException();
        }
    }
}

***********************************
Archivo: RepositorioEquipo.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\LogicaAccesoDatos\Repositorios\RepositorioEquipo.cs
***********************************
using ExcepcionesPropias.ExcepcionesEntidades;
using LogicaNegocio.EntidadesNegocio;
using LogicaNegocio.InterfacesRepositorio;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace LogicaAccesoDatos.Repositorios
{
    public class RepositorioEquipo : IRepositorioEquipo
    {
        public EmpresaContexto Contexto { get; set; }
        public RepositorioEquipo(EmpresaContexto contexto)
        {
            Contexto = contexto;
        }
        public void Add(Equipo item)
        {
            item.Validar();
            if (FindByName(item.Nombre) ==null)
            {
                Contexto.Add(item);
                Contexto.SaveChanges();
            }
            else
            {
                throw new EquipoException("Ya existe un equipo con ese nombre");
            }
        }

        public void Delete(Equipo item)
        {
            throw new NotImplementedException();
        }

        public IEnumerable<Equipo> FindAll()
        {
            return Contexto.Equipos.ToList();
        }

        public Equipo FindById(int id)
        {
            return Contexto.Equipos
                .Where(e => e.Id == id)
                .SingleOrDefault();
        }

        public Equipo FindByMail(string mail)
        {
            throw new NotImplementedException();
        }

        public Equipo FindByName(string name)
        {
            return Contexto.Equipos
                .Where(e => e.Nombre == name)
                .SingleOrDefault();
        }

        public void Update(Equipo item)
        {
            throw new NotImplementedException();
        }

        public Equipo UsuarioPorMailYPass(string mail, string pass)
        {
            throw new NotImplementedException();
        }
    }
}

***********************************
Archivo: RepositorioMetodoPago.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\LogicaAccesoDatos\Repositorios\RepositorioMetodoPago.cs
***********************************
using LogicaNegocio.EntidadesNegocio;
using LogicaNegocio.InterfacesRepositorio;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace LogicaAccesoDatos.Repositorios
{
    public class RepositorioMetodoPago : IRepositorioMetodoPago
    {
        public EmpresaContexto Contexto { get; set; }
        public RepositorioMetodoPago(EmpresaContexto contexto)
        {
            Contexto = contexto;
        }


        public void Add(MetodoPago item)
        {
            item.Validar();
            Contexto.Add(item);
            Contexto.SaveChanges();
        }

        public void Delete(MetodoPago item)
        {
            throw new NotImplementedException();
        }

        public IEnumerable<MetodoPago> FindAll()
        {
            return Contexto.MetodoPagos.ToList();
        }

        public MetodoPago FindById(int id)
        {
            return Contexto.MetodoPagos
                .Where(m => m.Id == id)
                .SingleOrDefault();
        }

        public MetodoPago FindByMail(string mail)
        {
            throw new NotImplementedException();
        }

        public void Update(MetodoPago item)
        {
            throw new NotImplementedException();
        }

        public MetodoPago UsuarioPorMailYPass(string mail, string pass)
        {
            throw new NotImplementedException();
        }

        public MetodoPago FindByName(string name)
        {
            throw new NotImplementedException();
        }
    }
}

***********************************
Archivo: RepositorioPago.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\LogicaAccesoDatos\Repositorios\RepositorioPago.cs
***********************************
using ExcepcionesPropias.ExcepcionesEntidades;
using LogicaNegocio.EntidadesNegocio;
using LogicaNegocio.InterfacesRepositorio;
using Microsoft.EntityFrameworkCore;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace LogicaAccesoDatos.Repositorios
{
    public class RepositorioPago : IRepositorioPago
    {
        public EmpresaContexto Contexto { get; set; }
        public RepositorioPago(EmpresaContexto contexto)
        {
            Contexto = contexto;
        }

        public void Add(Pago item)
        {
            item.Validar();
            if (FindById(item.Id) == null)
            {
                Contexto.Pagos.Add(item);
                Contexto.SaveChanges();

            }
            else
            {
                throw new PagoException("El pago ya existe en la base");
            }
        }

        public void Delete(Pago item)
        {
            throw new NotImplementedException();
        }

        public IEnumerable<Pago> FindAll()
        {
            var recurrente = Contexto.Pagos
                .OfType<PagoRecurrente>()
                .Include(p => p.MetodoPago)
                .Include(p => p.TipoGasto)
                .Include(p => p.Usuario).Include(u => u.Usuario.Rol)
            //casteo a Pago
            .ToList<Pago>();

            var unico = Contexto.Pagos
                .OfType<PagoUnico>()
                .Include(p => p.MetodoPago)
                .Include(p => p.TipoGasto)
                .Include(p => p.Usuario).Include(u => u.Usuario.Rol)
                //casteo a Pago
                .ToList<Pago>();

            // los uno en memoria
            recurrente.AddRange(unico);
            return recurrente;
        }

        public Pago FindById(int id)
        {
            return Contexto.Pagos
                .Include(p=>p.MetodoPago)
                .Include(p => p.TipoGasto)
                .Include(p => p.Usuario)
                .Where(p => p.Id == id)
                .SingleOrDefault();
        }

        public Pago FindByMail(string mail)
        {
            throw new NotImplementedException();
        }

        public void Update(Pago item)
        {
            throw new NotImplementedException();
        }

        public Pago UsuarioPorMailYPass(string mail, string pass)
        {
            throw new NotImplementedException();
        }

        public Pago FindByName(string name)
        {
            throw new NotImplementedException();
        }
        
        public IEnumerable<Pago> BuscarPagosMixtosPorFecha(DateTime fecha)
        {
            var rec = Contexto.Pagos
                .OfType<PagoRecurrente>()
                .Include(p => p.MetodoPago)
                .Include(p => p.TipoGasto)
                .Where(pr => pr.FechaDesde.Date <= fecha && pr.FechaHasta.Date >= fecha)
                //casteo a Pago
                .ToList<Pago>();

            var uni = Contexto.Pagos
                .OfType<PagoUnico>()
                .Include(p => p.MetodoPago)
                .Include(p => p.TipoGasto)
                .Where(pu => pu.FechaPago.Value != null && pu.FechaPago.Value <= fecha)
                //casteo a Pago
                .ToList<Pago>();

                // los uno en memoria
                rec.AddRange(uni);
            return rec;
        }

        public bool ExisteTipoGasto(int id)
        {
            return Contexto.Pagos
            .AsNoTracking()
            .Any(p => p.TipoGasto.Id == id);
        }

        public IEnumerable<PagoUnico> BuscarPagoUnicoPorMontoMayorA(decimal? valor)
        {
            var pagos = Contexto.Pagos.Include(p => p.Usuario)
         .OfType<PagoUnico>()
         .Where(p => p.MontoPago > valor)
         .GroupBy(p => p.Usuario.Id)
         .Select(g => g
             .OrderByDescending(p => p.FechaPago)  
             .First())
         .ToList();

            // uno por usuario, sin repetidos
            return pagos; 
        }
    }
}

***********************************
Archivo: RepositorioRol.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\LogicaAccesoDatos\Repositorios\RepositorioRol.cs
***********************************
using LogicaNegocio.EntidadesNegocio;
using LogicaNegocio.InterfacesRepositorio;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace LogicaAccesoDatos.Repositorios
{
    public class RepositorioRol : IRepositorioRol
    {
        public EmpresaContexto Contexto { get; set; }

        public RepositorioRol(EmpresaContexto contexto)
        {
            Contexto = contexto;
        }

        public void Add(Rol item)
        {
            item.Validar();
            Contexto.Roles.Add(item);
            Contexto.SaveChanges();
        }

        public void Delete(Rol item)
        {
            throw new NotImplementedException();
        }

        public IEnumerable<Rol> FindAll()
        {
            return Contexto.Roles.ToList();
        }

        public Rol FindById(int id)
        {
            return Contexto.Roles
                .Where(c => c.Id == id)
                .SingleOrDefault();
        }

        public Rol FindByMail(string mail)
        {
            throw new NotImplementedException();
        }

        public Rol FindByName(string name)
        {
            return Contexto.Roles
                .Where(c => c.Nombre == name)
                .SingleOrDefault();
        }

        public void Update(Rol item)
        {
            throw new NotImplementedException();
        }

        public Rol UsuarioPorMailYPass(string mail, string pass)
        {
            throw new NotImplementedException();
        }
    }
}

***********************************
Archivo: RepositorioTipoGastoEF.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\LogicaAccesoDatos\Repositorios\RepositorioTipoGastoEF.cs
***********************************
using ExcepcionesPropias.ExcepcionesEntidades;
using LogicaNegocio.EntidadesNegocio;
using LogicaNegocio.InterfacesRepositorio;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace LogicaAccesoDatos.Repositorios
{
    public class RepositorioTipoGastoEF : IRepositorioTipoGastos
    {

        public EmpresaContexto Contexto { get; set; }

        public RepositorioTipoGastoEF(EmpresaContexto contexto)
        {
            Contexto = contexto;
        }

        public void Add(TipoGasto item)
        {
            item.Validar();
            TipoGasto tipo = FindByName(item.Nombre);

            if (tipo == null)
            {
                Contexto.TiposGastos.Add(item);
                Contexto.SaveChanges();
            }
            else
            {
                throw new GastoException("Ya existe un tipo de gasto con el mismo nombre");
            }
        }

        public void Delete(TipoGasto item)
        {
            Contexto.TiposGastos.Remove(item);
            Contexto.SaveChanges();
        }

        public IEnumerable<TipoGasto> FindAll()
        {
            return Contexto.TiposGastos;
        }

        public TipoGasto FindById(int id)
        {
            return Contexto.TiposGastos
               .Where(t => t.Id == id)
               .SingleOrDefault();
        }

        private TipoGasto FindByName(string name)
        {
            return Contexto.TiposGastos
                .Where(t=> t.Nombre.ToUpper() == name.ToUpper())
                .SingleOrDefault();
        }
        public void Update(TipoGasto item)
        {
            TipoGasto tipogasto = FindByName(item.Nombre);
            if (tipogasto == null || tipogasto.Nombre == item.Nombre)
            {
                Contexto.SaveChanges();
            }
        }

        public TipoGasto FindByMail(string mail)
        {
            throw new NotImplementedException();
        }

        public TipoGasto UsuarioPorMailYPass(string mail, string pass)
        {
            throw new NotImplementedException();
        }

        TipoGasto IRepositorio<TipoGasto>.FindByName(string name)
        {
            return Contexto.TiposGastos
                .Where(t => t.Nombre == name)
                .SingleOrDefault();
        }
    }
}

***********************************
Archivo: RepositorioUsuario.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\LogicaAccesoDatos\Repositorios\RepositorioUsuario.cs
***********************************
using ExcepcionesPropias.ExcepcionesEntidades;
using LogicaNegocio.EntidadesNegocio;
using LogicaNegocio.InterfacesRepositorio;
using Microsoft.EntityFrameworkCore;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace LogicaAccesoDatos.Repositorios
{
    public class RepositorioUsuario : IRepositorioUsuario
    {
        //INYECCION DE DEPENDENCIA DE EMPRESACONTEXTO
        public EmpresaContexto Contexto { get; set; }
        public RepositorioUsuario(EmpresaContexto contexto)
        {
            Contexto = contexto;
        }

        public void Add(Usuario item)
        {
            item.Validar();
            Usuario usu = FindByMail(item.Mail);
            if (usu == null)
            {
                Contexto.Usuarios.Add(item);
                Contexto.SaveChanges();
            }
            else
            {
                throw new UsuarioException("El Usuario ya existe");
            }
        }

        private Usuario FindByMail(string mail)
        {
            return Contexto.Usuarios
                .Where(u => u.Mail == mail)
                .SingleOrDefault();
        }

        public void Delete(Usuario item)
        {
            throw new NotImplementedException();
        }

        public IEnumerable<Usuario> FindAll()
        {
            return Contexto.Usuarios.ToList();

        }

        public Usuario FindById(int id)
        {
            return Contexto.Usuarios
                .Where(u => u.Id == id)
                .SingleOrDefault();
        }

        public void Update(Usuario item)
        {
            throw new NotImplementedException();
        }
        Usuario IRepositorio<Usuario>.FindByMail(string mail)
        {
            return Contexto.Usuarios.
                Where(u => u.Mail == mail)
                .SingleOrDefault();
        }

        Usuario IRepositorio<Usuario>.UsuarioPorMailYPass(string mail, string pass)
        {
            return Contexto.Usuarios
                .Include(u=>u.Rol)
                .Where(u => u.Mail == mail && u.Password == pass)
                .SingleOrDefault();
        }

        public Usuario FindByName(string name)
        {
            throw new NotImplementedException();
        }
    }
}

***********************************
Archivo: MapperAuditoria.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\LogicaAplicacion\Mappers\MapperAuditoria.cs
***********************************
using CasosDeUso.DTOs.AuditoriaDTO;
using LogicaNegocio.EntidadesNegocio;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace LogicaAplicacion.Mappers
{
    public class MapperAuditoria
    {
        public static Auditoria AuditoriaDTOToAuditoria(AuditoriaDTO dto)
        {
            if (dto == null)
                throw new ArgumentNullException(nameof(dto));

            return Auditoria.Crear(
                accion: dto.Accion,
                usuarioId: dto.UsuarioId,
                usuarioNombre: dto.NombreUsuario,
                nombreTipoGasto: dto.TipoGastoNombre,
                descripcionTipoGasto: dto.DescripcionTipoGasto,
                fechaUtc: dto.Fecha
            );
        }

    }
}

***********************************
Archivo: MapperEquipo.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\LogicaAplicacion\Mappers\MapperEquipo.cs
***********************************
using CasosDeUso.DTOs.EquipoDTO;
using LogicaNegocio.EntidadesNegocio;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace LogicaAplicacion.Mappers
{
    public class MapperEquipo
    {
        public static IEnumerable<EquipoDTOs> ListEquipoToListEquipoDTO(IEnumerable<Equipo> equipoDTO)
        {
            List<EquipoDTOs> listadoEquipo = new List<EquipoDTOs>();
            if (equipoDTO == null)
            {
                throw new ArgumentNullException("El equipo no existe");
            }
            foreach (Equipo equipo in equipoDTO)
            {
                listadoEquipo.Add(new EquipoDTOs()
                {
                    Nombre = equipo.Nombre,
                    Id = equipo.Id,
                });
            }
            return listadoEquipo;
        }
    }
}

***********************************
Archivo: MapperMetodoPago.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\LogicaAplicacion\Mappers\MapperMetodoPago.cs
***********************************
using CasosDeUso.DTOs.MetodoPagoDTO;
using CasosDeUso.DTOs.TipoGastoDTOs;
using LogicaNegocio.EntidadesNegocio;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace LogicaAplicacion.Mappers
{
    public class MapperMetodoPago
    {
        public static MetodoPago MetodoPagoDTOToMetodoPago(MetodoPagoDTO metodoPagoDTO)
        {
            if (metodoPagoDTO == null)
            {
                throw new ArgumentNullException("Datos incorrectos");
            }
            return new MetodoPago(metodoPagoDTO.Descripcion);
        }


        public static DetalleMetodoPagoDTO MetodoPagoToMetodoPagoDTO(MetodoPago metodoPago)
        {
            if(metodoPago == null)
            {
                throw new ArgumentNullException("Datos incorrectos");
            }
            return new DetalleMetodoPagoDTO()
            {
                Id = metodoPago.Id,
                Descripcion = metodoPago.Descripcion,
            };
        }



        public static IEnumerable<ListadoMetodoPagoDTO> ListMetodoPagoToMetodoPagoDTO(IEnumerable<MetodoPago> metodoPagos)
        {
            List<ListadoMetodoPagoDTO> listadoMetodoPago = new List<ListadoMetodoPagoDTO>();

            foreach (MetodoPago metodoPago in metodoPagos)
            {
                listadoMetodoPago.Add(new ListadoMetodoPagoDTO()
                {
                    Id = metodoPago.Id,
                    Descripcion = metodoPago.Descripcion,
                });
            }
            return listadoMetodoPago;
        }
    }

}

***********************************
Archivo: MapperPago.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\LogicaAplicacion\Mappers\MapperPago.cs
***********************************
using CasosDeUso.DTOs.MetodoPagoDTO;
using CasosDeUso.DTOs.PagoDTO;
using CasosDeUso.DTOs.PagoRecurrenteDTO;
using CasosDeUso.DTOs.PagoUnicoDTO;
using CasosDeUso.DTOs.TipoGastoDTOs;
using ExcepcionesPropias.ExcepcionesEntidades;
using LogicaNegocio.EntidadesNegocio;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace LogicaAplicacion.Mappers
{
    public class MapperPago
    {
        public static PagoUnico PagoUnicoDTOToPagoUnico(PagoUnicoDTO pagoUnicoDTO, Usuario ususario, TipoGasto tipoGasto, MetodoPago metodoPago)
        {
            return new PagoUnico(metodoPago, tipoGasto, ususario, pagoUnicoDTO.Descripcion, pagoUnicoDTO.NumeroRecibo, pagoUnicoDTO.FechaPago, pagoUnicoDTO.MontoPago);
        }

        public static PagoRecurrente PagoRecurrenteDTOToPagoRecuerrente(PagoRecurrenteDTO pagoRecurrenteDTO, Usuario ususario, TipoGasto tipoGasto, MetodoPago metodoPago)
        {
            if (pagoRecurrenteDTO == null)
            {
                throw new ArgumentNullException("Datos incorrectos");
            }
            return new PagoRecurrente(metodoPago, tipoGasto, ususario, pagoRecurrenteDTO.Descripcion, pagoRecurrenteDTO.FechaDesde, pagoRecurrenteDTO.FechaHasta, pagoRecurrenteDTO.ValorCompra);
        }


        public static List<ListaFiltroPagoXFecha> PagoUnicoFiltradoToPagoUnicoFiltradoDTO(IEnumerable<Pago> Pago)
        {
            List<ListaFiltroPagoXFecha> listaFiltro = new List<ListaFiltroPagoXFecha>();

            foreach(Pago pagoTotales in Pago)
            {
                listaFiltro.Add(new ListaFiltroPagoXFecha()
                {
                    Id = pagoTotales.Id,
                    NombreMetodoPago = pagoTotales.MetodoPago.Descripcion,
                    NombreTipoGasto = pagoTotales.TipoGasto.Nombre,
                    NombreGasto = pagoTotales.Descripcion,
                    FechaCompra = (DateTime)pagoTotales.ObtenerFechaPago(),
                    ValorCompra = (decimal)pagoTotales.ValorCompras(),
                    SaldoPendiente = pagoTotales.CalcularSaldoPendiente(),
                });
            }
            return listaFiltro;
        }


        public static List<ListadoPagoDTO> ListadoPagoToListadoPagoDTO(IEnumerable<Pago> pagos)
        {
            List<ListadoPagoDTO> listaPagos = new List<ListadoPagoDTO>();

            foreach (Pago p in pagos)
            {
                listaPagos.Add(new ListadoPagoDTO()
                {
                    IdPago = p.Id,
                    MetodoPago = p.MetodoPago.Descripcion,
                    TipoPago = p.TipoGasto.Nombre,
                    DescripcionPago = p.TipoGasto.Descripcion,
                    NombreUsuario = p.Usuario.Nombre,
                    RolUsuario = p.Usuario.Rol.Nombre,
                    DescTipoPago = p.Descripcion,
                    Montopago = p.ValorCompras(),
                });
            }
                return listaPagos;
        }

        public static IEnumerable<ListaPagoUnicoMayorADTO> PagoUnicoToPagoUnicoDTO(IEnumerable<PagoUnico> pagos)
        {
            List<ListaPagoUnicoMayorADTO> listaPagosMayorA = new List<ListaPagoUnicoMayorADTO>();

            foreach (PagoUnico pagoU in pagos)
            {
                listaPagosMayorA.Add(new ListaPagoUnicoMayorADTO()
                {
                    IdPgo = pagoU.Id,
                    DescripcionPago = pagoU.Descripcion,
                    NombreUsuario = pagoU.Usuario.Nombre,
                    ValorCompra = pagoU.MontoPago
                });
            }
            return listaPagosMayorA;
        }

        public static BuscarPagoPorIdDTO BuscarPagoPorIdToBuscarPagoPorIdDTO(Pago pago)
        {
            if (pago == null)
            {
                throw new ArgumentNullException("Datos incorrectos");
            }
            return new BuscarPagoPorIdDTO()
            {
                IdPago = pago.Id,
                MetodoPago = pago.MetodoPago.Descripcion,
                TipoPago = pago.TipoGasto.Nombre,
                UsuarioId = pago.Usuario.Id,
                NombreUsuario = pago.Usuario.Nombre,
                DescripcionPago = pago.Descripcion,
                MontoPago = pago.ValorCompras()
            };
            
        }


    }
}

***********************************
Archivo: MapperRol.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\LogicaAplicacion\Mappers\MapperRol.cs
***********************************
using CasosDeUso.DTOs.RolDTO;
using LogicaNegocio.EntidadesNegocio;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace LogicaAplicacion.Mappers
{
    public class MapperRol
    {
        public static Rol RolDTOToRol(AltaRolDTO rolDTO)
        {
            if (rolDTO == null)
            {
                throw new ArgumentNullException("Datos incorrectos");
            }
            return new Rol(rolDTO.NombreRol);
        }

        public static IEnumerable<ListarRolParaAltaUsuarioDTO> ListadoRolToListadoRolDTO(IEnumerable<Rol> rol)
        {
            List<ListarRolParaAltaUsuarioDTO> listadoRol = new List<ListarRolParaAltaUsuarioDTO>();

            foreach (Rol r in rol)
            {
                if (r.Nombre != "Administrador")
                {

                    listadoRol.Add(new ListarRolParaAltaUsuarioDTO()
                    {
                        Id = r.Id,
                        Nombre = r.Nombre,
                    });
                }

            }
            return listadoRol;
        }


        public static IEnumerable<ListadoRolParaLoginDTO> ListadoRolLoginToListadoRolLoginDTO(IEnumerable<Rol> rol)
        {
            List<ListadoRolParaLoginDTO> listadoRol = new List<ListadoRolParaLoginDTO>();

            foreach (Rol r in rol)
            {
                listadoRol.Add(new ListadoRolParaLoginDTO()
                {
                    Id = r.Id,
                    Nombre = r.Nombre,
                });
            }
            return listadoRol;
        }


    }
}

***********************************
Archivo: MapperTipoGasto.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\LogicaAplicacion\Mappers\MapperTipoGasto.cs
***********************************
using CasosDeUso.DTOs.TipoGastoDTOs;
using LogicaNegocio.EntidadesNegocio;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace LogicaAplicacion.Mappers
{
    public class MapperTipoGasto
    {
        //Recibo un TipoGastoDTO y convierto a TipoGasto
        public static TipoGasto TipoGastoDTOToTipoGasto(TipoGastoDTO tipogastoDTO)
        {
            if (tipogastoDTO == null)
            {
                throw new ArgumentNullException("Datos incorrectos");
            }
            return new TipoGasto(tipogastoDTO.Nombre, tipogastoDTO.Descripcion);
        }


        public static IEnumerable<ListadoTipoGastoDTO> ListTipoGastoToTipoGastoDTO(IEnumerable<TipoGasto> tipoGastos)
        {
            List<ListadoTipoGastoDTO> listadoTipoGastos = new List<ListadoTipoGastoDTO>();
            
            foreach (TipoGasto tipogasto in tipoGastos)
            {
                listadoTipoGastos.Add(new ListadoTipoGastoDTO()
                {
                    Id = tipogasto.Id,
                    Nombre = tipogasto.Nombre,
                    Descripcion = tipogasto.Descripcion
                });
            }
            return listadoTipoGastos;
        }

        //Recibo un TipoGasto y convierto a TipoGastoDTO
        public static DetalleTipoGastoDTO TipoGastoToDetalleTipoGastoDTO(TipoGasto tipoGasto) 
        {
            if (tipoGasto == null)
            {
                throw new ArgumentNullException("Datos incorrectos");
            }
            return new DetalleTipoGastoDTO()
            {
                Id = tipoGasto.Id,
                Nombre = tipoGasto.Nombre,
                Descripcion = tipoGasto.Descripcion,
            };
        }
    }
}

***********************************
Archivo: MapperUsuario.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\LogicaAplicacion\Mappers\MapperUsuario.cs
***********************************
using CasosDeUso.DTOs.TipoGastoDTOs;
using CasosDeUso.DTOs.UsuarioDTOs;
using LogicaAplicacion.CasosUso.CUUsuario;
using LogicaNegocio.EntidadesNegocio;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace LogicaAplicacion.Mappers
{
    public class MapperUsuario
    {
        //Recibo un UsuarioDTO y convierto a Usuario
        public static Usuario UsuarioDTOToUsuario(AltaUsuarioDTO usuarioDTO, string mail, Equipo equipo, Rol rol)
        {
            if (usuarioDTO == null)
            {
                throw new ArgumentNullException("Datos incorrectos");
            }
            return new Usuario(usuarioDTO.Nombre, usuarioDTO.Apellido, usuarioDTO.Pass, mail, rol, equipo);
        }


        //Recibo un usuario y convierto a usuarioDTO
        public static DetalleLoginUsuarioDTO UsuarioLoginDTOToUsuarioLogin(Usuario usuario)
        {
            if (usuario == null)
            {
                throw new ArgumentNullException("Datos incorrectos");
            }
            return new DetalleLoginUsuarioDTO()
            {
                Id = usuario.Id,
                Nombre = usuario.Nombre,
                Mail = usuario.Mail,
                Password = usuario.Password,
                Rol = usuario.Rol.Nombre,

            };

        }

        public static IEnumerable<ListadoUsuarioDTO> ListUsuarioToListUsusarioDTO(IEnumerable<Usuario> usuarios)
        {
            List<ListadoUsuarioDTO> listadoUsuarios = new List<ListadoUsuarioDTO>();

            foreach (Usuario usario in usuarios)
            {
                listadoUsuarios.Add(new ListadoUsuarioDTO()
                {
                    Id = usario.Id,
                    Nombre = usario.Nombre,
                    Mail = usario.Mail,

                });
            }
            return listadoUsuarios;
        }
    }
}

***********************************
Archivo: Auditoria.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\LogicaNegocio\EntidadesNegocio\Auditoria.cs
***********************************
using LogicaNegocio.InterfacesEntidades;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace LogicaNegocio.EntidadesNegocio
{
    public class Auditoria : IValidable
    {
        public int Id { get; private set; }

        public string Accion { get; set; }

        
        public DateTime FechaUtc { get; private set; }

        public int UsuarioId { get; private set; }
        public string NombreUsuario { get; set; }
        public string TipoGastoNombre { get; private set; }  

        public string TipoGastoDesc { get; set; }

        // Requerido por EF
        protected Auditoria() { }

        
        public static Auditoria Crear(string accion, int usuarioId, string usuarioNombre ,string nombreTipoGasto, string descripcionTipoGasto,DateTime fechaUtc)
        {
            var a = new Auditoria
            {
                Accion = accion,
                UsuarioId = usuarioId,
                NombreUsuario = usuarioNombre,
                TipoGastoNombre = nombreTipoGasto,
                TipoGastoDesc = descripcionTipoGasto,
                FechaUtc = fechaUtc,
            };

            a.Validar();
            return a;
        }

        public void Validar()
        {
            if (string.IsNullOrEmpty(Accion))
                throw new ArgumentException("Acción de auditoría inválida", nameof(Accion));

            if (FechaUtc == default)
                throw new ArgumentException("La fecha no puede ser el valor por defecto", nameof(FechaUtc));

            if (UsuarioId <= 0)
                throw new ArgumentException("UsuarioId debe ser mayor que cero", nameof(UsuarioId));
        }
       
    }
}












***********************************
Archivo: Equipo.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\LogicaNegocio\EntidadesNegocio\Equipo.cs
***********************************
using ExcepcionesPropias.ExcepcionesEntidades;
using LogicaNegocio.InterfacesEntidades;
using Microsoft.EntityFrameworkCore;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Numerics;
using System.Text;
using System.Threading.Tasks;
using System.Xml.Linq;

namespace LogicaNegocio.EntidadesNegocio
{
    [Index(nameof(Nombre), IsUnique = true)]
    public class Equipo:IValidable
    {
        public int Id { get; set; }
        public string Nombre { get; set; }

        protected Equipo() { }
        public Equipo(string nombre)
        {
            Nombre = nombre;
            Validar();
        }

        public void Validar()
        {
            if (string.IsNullOrEmpty(Nombre))
            {
                throw new EquipoException("El nombre de equipo no puede ser vacio");
            }
        }
    }
}

***********************************
Archivo: MetodoPago.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\LogicaNegocio\EntidadesNegocio\MetodoPago.cs
***********************************
using ExcepcionesPropias.ExcepcionesEntidades;
using LogicaNegocio.InterfacesEntidades;
using Microsoft.EntityFrameworkCore;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using static System.Runtime.InteropServices.JavaScript.JSType;

namespace LogicaNegocio.EntidadesNegocio
{
    [Index(nameof(Descripcion), IsUnique = true)]
    public class MetodoPago:IValidable
    {
        public int Id { get; set; }
        public string Descripcion { get; private set; }

        public MetodoPago(string descripcion)
        {
            Descripcion = descripcion;
        }

        protected MetodoPago() { }


        public void Validar()
        {
            ValidarDescripcion();

        }

        private void ValidarDescripcion()
        {
            if(Descripcion == null)
            {
                throw new MetodoPagoException("La descripcion no puede ser vacia");
            }
        }
    }
}

***********************************
Archivo: Pago.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\LogicaNegocio\EntidadesNegocio\Pago.cs
***********************************
using LogicaNegocio.InterfacesEntidades;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using ExcepcionesPropias.ExcepcionesEntidades;

namespace LogicaNegocio.EntidadesNegocio
{
    public abstract class Pago: IValidable
    {
        public int Id { get; set; }
        public MetodoPago MetodoPago { get; set; }
        public TipoGasto TipoGasto { get; set; }
        public Usuario Usuario { get; set; }
        public string Descripcion { get; set; }


        protected Pago(){}

        public Pago(MetodoPago metodoPago, TipoGasto tipogasto, Usuario usuario, string descripcion)
        {
            MetodoPago = metodoPago;
            TipoGasto = tipogasto;
            Usuario = usuario;
            Descripcion = descripcion;

            Validar();
        }

        public abstract decimal CalcularSaldoPendiente();
        public abstract decimal? ValorCompras();
        public abstract DateTime? ObtenerFechaPago();

        public void Validar()
        {
            ValidarMetodoPago();
            ValidarTipoGasto();
            ValidarUsuario();
            ValidarDescripcion();
        }

        private void ValidarMetodoPago() 
        {
            if( MetodoPago is null)
            {
                throw new PagoException("El método de pago no puede ser vaco");
            }
        }

        private void ValidarTipoGasto()
        {
            if(TipoGasto is null)
            {
                throw new PagoException("El Tipo de gasto no puede ser vacio");
            }
        }
        private void ValidarUsuario()
        {
            if (Usuario is null)
            {
                throw new PagoException("El usuario no puede ser vacío");
            }
        }
        private void ValidarDescripcion() 
        {
            if(string.IsNullOrEmpty( Descripcion))
            {
                throw new PagoException("La descripción no puede ser vacía");
            }
        }
    }

    
}

***********************************
Archivo: PagoRecurrente.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\LogicaNegocio\EntidadesNegocio\PagoRecurrente.cs
***********************************
using ExcepcionesPropias.ExcepcionesEntidades;
using LogicaNegocio.InterfacesEntidades;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace LogicaNegocio.EntidadesNegocio
{
    public class PagoRecurrente : Pago, IValidable
    {
        public DateTime FechaDesde { get; set; }
        public DateTime FechaHasta { get; set; }
        public decimal? ValorCompra { get; set; }

        public PagoRecurrente(MetodoPago metodoPago, TipoGasto tipogasto, Usuario usuario, string descripcion, DateTime fechaDesde, DateTime fechaHasta, decimal valorComrpa)
            : base(metodoPago, tipogasto, usuario, descripcion)
        {
            FechaDesde = fechaDesde;
            FechaHasta = fechaHasta;
            ValorCompra = valorComrpa;
            Validar();
        }
        protected PagoRecurrente() : base() { }


        //public override DateTime? ObtenerFechaDesde() => FechaDesde;

        public override decimal? ValorCompras()
        {
            return ValorCompra;
        }
        public override DateTime? ObtenerFechaPago()
        {
            return FechaDesde.Date;
        }

        public override decimal CalcularSaldoPendiente()

        {
            // Fecha actual
            DateTime hoy = DateTime.Today;

            // Si todavía no empezó el período, se debe todo
            if (hoy < FechaDesde)
                return (decimal)ValorCompra;

            // Si ya terminó el período, no se debe nada
            if (hoy > FechaHasta)
                return 0m;

            // Calculo total de meses del período
            int totalMeses = ((FechaHasta.Year - FechaDesde.Year) * 12) + (FechaHasta.Month - FechaDesde.Month) + 1;

            // Calculo cuántos meses ya pasaron
            int mesesPagados = ((hoy.Year - FechaDesde.Year) * 12) + (hoy.Month - FechaDesde.Month);

            // Aseguo de que no se pase de rango
            if (mesesPagados > totalMeses)
                mesesPagados = totalMeses;

            // Calculo los meses que faltan
            int mesesRestantes = totalMeses - mesesPagados;

            // Calculo el valor mensual
            decimal valorPorMes = (decimal)(ValorCompra / totalMeses);

            // Calculo saldo pendiente
            decimal saldo = valorPorMes * mesesRestantes;

            // Redondeo
            return Math.Round(saldo, 2);
        }

        public void Validar()
        {
            ValidarFechas();
            ValidarValorCompra();
        }

        //El ingreso minimo de mi fecha sera 01-01-2023 (Validacion personal)
        private static readonly DateTime MinFecha = new DateTime(2023, 1, 1);

        private void ValidarFechas()
        {
            var desde = FechaDesde.Date;
            var hasta = FechaHasta.Date;
            var hoy = DateTime.Today;

            
            if (desde < MinFecha)
                throw new PagoException("La Fecha Desde no puede ser anterior a 01/01/2023.");

            if (hasta < MinFecha)
                throw new PagoException("La Fecha Hasta no puede ser anterior a 01/01/2023.");

            if (hasta <= desde)
                throw new PagoException("La Fecha Hasta debe ser posterior a la Fecha Desde.");

            if (hasta < hoy)
                throw new PagoException("La Fecha Hasta no puede ser anterior a hoy.");

        }
        private void ValidarValorCompra()
        {
            if (ValorCompra <= 0m)
                throw new PagoException("El valor de compra debe ser mayor a 0.");
        }
    }
}

***********************************
Archivo: PagoUnico.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\LogicaNegocio\EntidadesNegocio\PagoUnico.cs
***********************************
using ExcepcionesPropias.ExcepcionesEntidades;
using LogicaNegocio.InterfacesEntidades;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace LogicaNegocio.EntidadesNegocio
{
    public class PagoUnico : Pago, IValidable
    {
        public int? NumeroRecibo { get; set; }
        public DateTime? FechaPago { get; set; }
        public decimal? MontoPago { get; set; }


        public PagoUnico(MetodoPago metodoPago, TipoGasto tipogasto, Usuario usuario, string descripcion, int nunrecibo, DateTime fechaPago, decimal montopago)
            :base(metodoPago, tipogasto, usuario, descripcion)
        {
            NumeroRecibo = nunrecibo;
            FechaPago = fechaPago;
            MontoPago = montopago;
            Validar();
        }
        public override decimal CalcularSaldoPendiente() => 0m;
        public override DateTime? ObtenerFechaPago()
        {
            return FechaPago;
        }
        protected PagoUnico():base() { }

        public override decimal? ValorCompras()
        {
            return MontoPago;
        }

        public void Validar()
        {
            ValidarNumRecibo();
            ValidarFechaPago();
            ValidarMontoPago();
        }

        private void ValidarNumRecibo()
        {
            if (NumeroRecibo == 0)
            {
                throw new PagoException("El campo tiene que contener un numero de recibo");
            }
            if(NumeroRecibo == null)
            {
                throw new PagoException("El numero de recibo no puede ser vacio");
            }

        }

        private void ValidarFechaPago()
        {
            if(FechaPago == null)
            {
                throw new PagoException("La fecha de pago no puede ser vacia");
            }
        }

        private void ValidarMontoPago()
        {
            if (!MontoPago.HasValue || MontoPago.Value <= 0m)
            {
                throw new PagoException("El Monto de pago debe ser mayor a 0.");
            }
        }

        
    }
}

***********************************
Archivo: Rol.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\LogicaNegocio\EntidadesNegocio\Rol.cs
***********************************
using ExcepcionesPropias.ExcepcionesEntidades;
using Microsoft.EntityFrameworkCore;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace LogicaNegocio.EntidadesNegocio
{
    [Index(nameof(Nombre), IsUnique = true)]
    public class Rol
    {
        public int Id { get; set; }
        public string Nombre { get; set; }

        public Rol(string nombre)
        {
            Nombre = nombre;
            Validar();
        }

        protected Rol(){}


        public void Validar()
        {
            if (string.IsNullOrEmpty(Nombre))
            {
                throw new RolException("El nombre del Rol no puede ser vacio");
            }
        }
    }
}

***********************************
Archivo: TipoGasto.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\LogicaNegocio\EntidadesNegocio\TipoGasto.cs
***********************************
using ExcepcionesPropias.ExcepcionesEntidades;
using LogicaNegocio.InterfacesEntidades;
using Microsoft.EntityFrameworkCore;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace LogicaNegocio.EntidadesNegocio
{
    [Index(nameof(Nombre), IsUnique = true, Name = "UX_TipoGasto_Nombre")]
    public class TipoGasto : IValidable
    {

        public int Id { get; private set; }
        public string Nombre { get; set; }
        public string Descripcion { get; set; }

        public TipoGasto(string nombre, string descripcion)
        {
            Nombre = nombre;
            Descripcion = descripcion;
            Validar();
        }


        protected TipoGasto(){}


        public void Validar()
        {
            ValidarNombreVacio();
            ValidarDescripcionVacia();
        }

        private void ValidarNombreVacio()
        {
            if (string.IsNullOrEmpty(Nombre))
            {
                throw new GastoException("El nombre es obligatorio");
            }
        }

        private void ValidarDescripcionVacia()
        {
            if (string.IsNullOrEmpty(Descripcion))
            {
                throw new GastoException("La descripcion es obligatoria");
            }
        }

    }
}

***********************************
Archivo: Usuario.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\LogicaNegocio\EntidadesNegocio\Usuario.cs
***********************************
using ExcepcionesPropias.ExcepcionesEntidades;
using LogicaNegocio.InterfacesEntidades;
using Microsoft.EntityFrameworkCore;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Xml.Linq;

namespace LogicaNegocio.EntidadesNegocio
{
    [Index(nameof(Mail),IsUnique =true)]
    public class Usuario: IValidable
    {
        public int Id { get; set; }
        public string Nombre { get; set; }
        public string Apellido { get; set; }
        public string Password { get; set; }
        public string Mail { get; set; }
        public Rol  Rol { get; set; }
        public Equipo Equipo { get; set; }


        protected Usuario() { }

        public Usuario(string nombre, string apellido, string pass, string mail,Rol rol, Equipo equipo)
        {
            Nombre = nombre;
            Apellido = apellido;
            Password = pass;
            Mail = mail;
            Rol = rol;
            Equipo = equipo;

            Validar();
        }

        public void Validar()
        {
            ValidarNombre();
            ValidarApellido();
            ValidarPassword();
            ValidarMail();
        }

        private void ValidarNombre()
        {
            if (Nombre == null)
            {
                throw new UsuarioException("El nombre no puede ser vacio");
            }
        }

        private void ValidarApellido()
        {
            if(Apellido == null)
            {
                throw new UsuarioException("El apellido no puede ser vacio");
            }
        }

        private void ValidarPassword()
        {
            if(Password == null)
            {
                throw new UsuarioException("El password no puede ser vacio");
            }
            if (Password.Length < 8)
            {
                throw new UsuarioException("La contraseña debe tener por lo menos 8 caracteres");
            }
        }

        private void ValidarMail()
        {
            if(Mail == null)
            {
                throw new UsuarioException("El mail no puede ser vacio");
            }
            
        }
    }
}

***********************************
Archivo: IValidable.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\LogicaNegocio\InterfacesEntidades\IValidable.cs
***********************************
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace LogicaNegocio.InterfacesEntidades
{
    public interface IValidable
    {
        void Validar();
    }
}

***********************************
Archivo: IRepositorio.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\LogicaNegocio\InterfacesRepositorio\IRepositorio.cs
***********************************
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace LogicaNegocio.InterfacesRepositorio
{
    public interface IRepositorio<T>
    {
        void Add(T item);
        void Update(T item);
        void Delete(T item);
        T FindById(int id);
        IEnumerable<T> FindAll();
        T FindByMail(string mail);
        T UsuarioPorMailYPass(string mail, string pass);
        T FindByName(string name);
    }
}

***********************************
Archivo: IRepositorioAuditoria.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\LogicaNegocio\InterfacesRepositorio\IRepositorioAuditoria.cs
***********************************
using LogicaNegocio.EntidadesNegocio;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace LogicaNegocio.InterfacesRepositorio
{
    public interface IRepositorioAuditoria:IRepositorio<Auditoria>
    {
    }
}

***********************************
Archivo: IRepositorioEquipo.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\LogicaNegocio\InterfacesRepositorio\IRepositorioEquipo.cs
***********************************
using LogicaNegocio.EntidadesNegocio;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace LogicaNegocio.InterfacesRepositorio
{
    public interface IRepositorioEquipo:IRepositorio<Equipo>
    {
        Equipo FindByName(string nombre);
    }
}

***********************************
Archivo: IRepositorioMetodoPago.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\LogicaNegocio\InterfacesRepositorio\IRepositorioMetodoPago.cs
***********************************
using LogicaNegocio.EntidadesNegocio;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace LogicaNegocio.InterfacesRepositorio
{
    public interface IRepositorioMetodoPago: IRepositorio<MetodoPago>
    {
    }
}

***********************************
Archivo: IRepositorioPago.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\LogicaNegocio\InterfacesRepositorio\IRepositorioPago.cs
***********************************
using LogicaNegocio.EntidadesNegocio;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace LogicaNegocio.InterfacesRepositorio
{
    public interface IRepositorioPago:IRepositorio<Pago>
    {
        IEnumerable<Pago> BuscarPagosMixtosPorFecha(DateTime fecha);
        bool ExisteTipoGasto(int id);
        IEnumerable<PagoUnico> BuscarPagoUnicoPorMontoMayorA(decimal? valor);
    }
}

***********************************
Archivo: IRepositorioRol.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\LogicaNegocio\InterfacesRepositorio\IRepositorioRol.cs
***********************************
using LogicaNegocio.EntidadesNegocio;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace LogicaNegocio.InterfacesRepositorio
{
    public interface IRepositorioRol: IRepositorio<Rol>
    {

    }
}

***********************************
Archivo: IRepositorioTipoGastos.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\LogicaNegocio\InterfacesRepositorio\IRepositorioTipoGastos.cs
***********************************
using LogicaNegocio.EntidadesNegocio;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace LogicaNegocio.InterfacesRepositorio
{
    public interface IRepositorioTipoGastos:IRepositorio<TipoGasto>
    {
       
    }
}

***********************************
Archivo: IRepositorioUsuario.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\LogicaNegocio\InterfacesRepositorio\IRepositorioUsuario.cs
***********************************
using LogicaNegocio.EntidadesNegocio;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace LogicaNegocio.InterfacesRepositorio
{
    public interface IRepositorioUsuario:IRepositorio<Usuario>
    {
    }
}

***********************************
Archivo: EquipoController.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\Presentacion\Controllers\EquipoController.cs
***********************************
using CasosDeUso.DTOs.EquipoDTO;
using CasosDeUso.InterfacesCU.ICUEquipo;
using ExcepcionesPropias.ExcepcionesEntidades;
using Microsoft.AspNetCore.Http;
using Microsoft.AspNetCore.Mvc;

namespace Presentacion.Controllers
{
    public class EquipoController : Controller
    {
        public ICUAltaEquipo CUAltaEquipo { get; set; }
        public ICUListarEquipo CUListarEquipo { get; set; }
        
        
        public EquipoController(ICUAltaEquipo cuAltaEquipo, ICUListarEquipo cuListarEquipo)
        {
            CUAltaEquipo = cuAltaEquipo;
            CUListarEquipo = cuListarEquipo;
        }




        // GET: EquipoController
        public ActionResult Index()
        {
            IEnumerable<EquipoDTOs> listaEquipo = new List<EquipoDTOs>();
            try
            {
                listaEquipo = CUListarEquipo.Ejecutar();
            }
            catch (Exception ex) 
            {
                ViewBag.Mensaje = "Error";
            }
            return View(listaEquipo);
        }

        // GET: EquipoController/Details/5
        public ActionResult Details(int id)
        {
            return View();
        }

        // GET: EquipoController/Create
        public ActionResult Create()
        {
            return View();
        }

        // POST: EquipoController/Create
        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult Create(EquipoDTOs equipoDTO)
        {
            try
            {
                if (ModelState.IsValid)
                {
                    CUAltaEquipo.Ejecutar(equipoDTO.Nombre);
                    return RedirectToAction(nameof(Index));
                }

            }
            catch (EquipoException ex)
            {
                ViewBag.Mensaje = ex.Message;
            }
            catch (ArgumentNullException ex)
            {
                ViewBag.Mensaje = ex.Message;
            }
            catch (Exception ex)
            {
                ViewBag.Mensaje = "Error";
            }
                return View(equipoDTO);
        }

        // GET: EquipoController/Edit/5
        public ActionResult Edit(int id)
        {
            return View();
        }

        // POST: EquipoController/Edit/5
        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult Edit(int id, IFormCollection collection)
        {
            try
            {
                return RedirectToAction(nameof(Index));
            }
            catch
            {
                return View();
            }
        }

        // GET: EquipoController/Delete/5
        public ActionResult Delete(int id)
        {
            return View();
        }

        // POST: EquipoController/Delete/5
        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult Delete(int id, IFormCollection collection)
        {
            try
            {
                return RedirectToAction(nameof(Index));
            }
            catch
            {
                return View();
            }
        }
    }
}

***********************************
Archivo: HomeController.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\Presentacion\Controllers\HomeController.cs
***********************************
using Microsoft.AspNetCore.Mvc;
using Presentacion.Models;
using System.Diagnostics;

namespace Presentacion.Controllers
{
    public class HomeController : Controller
    {
        private readonly ILogger<HomeController> _logger;

        public HomeController(ILogger<HomeController> logger)
        {
            _logger = logger;
        }

        public IActionResult Index()
        {
            return View();
        }

        public IActionResult Privacy()
        {
            return View();
        }

        [ResponseCache(Duration = 0, Location = ResponseCacheLocation.None, NoStore = true)]
        public IActionResult Error()
        {
            return View(new ErrorViewModel { RequestId = Activity.Current?.Id ?? HttpContext.TraceIdentifier });
        }
    }
}

***********************************
Archivo: MetodoPagoController.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\Presentacion\Controllers\MetodoPagoController.cs
***********************************
using CasosDeUso.DTOs.MetodoPagoDTO;
using CasosDeUso.InterfacesCU.ICUListadoMetodoPago;
using CasosDeUso.InterfacesCU.ICUMetodoPago;
using ExcepcionesPropias.ExcepcionesEntidades;
using Microsoft.AspNetCore.Http;
using Microsoft.AspNetCore.Mvc;

namespace Presentacion.Controllers
{
    public class MetodoPagoController : Controller
    {
        
        public ICUAltaMetodoPago CUAltaMetodoPago { get; set; }
        public ICUListadoMetodoPago CUListadoMetodoPago { get; set; }
        public ICUBucarMetodoPago CUBucarMetodoPago { get; set; }
        public MetodoPagoController(ICUAltaMetodoPago cUAltaMetodoPago, ICUListadoMetodoPago cUListadoMetodoPago, ICUBucarMetodoPago cUBucarMetodoPago)
        {
            CUAltaMetodoPago = cUAltaMetodoPago;
            CUListadoMetodoPago = cUListadoMetodoPago;
            CUBucarMetodoPago = cUBucarMetodoPago;
        }



        // GET: MetodoPagoController
        public ActionResult Index()
        {
            IEnumerable<ListadoMetodoPagoDTO> listadoMetodoPagos = new List<ListadoMetodoPagoDTO>();
            try
            {
                listadoMetodoPagos = CUListadoMetodoPago.Ejecutar();
            }
            catch (Exception ex)
            {
                ViewBag.Mensaje = "Error";
            }

            return View(listadoMetodoPagos);
        }

        // GET: MetodoPagoController/Details/5
        public ActionResult Details(int id)
        {
            DetalleMetodoPagoDTO detalleMetodoPagoDTO = new DetalleMetodoPagoDTO();

            try
            {
                if(id > 0)
                {
                    detalleMetodoPagoDTO=CUBucarMetodoPago.Ejecutar(id);
                }
                else
                {
                    throw new ArgumentException("El id no es correcto");
                }
            }
            catch (MetodoPagoException ex)
            {
                ViewBag.Mensaje = ex.Message;
            }
            catch(ArgumentNullException ex)
            {
                ViewBag.Mensaje = ex.Message;
            }
            catch(Exception ex)
            {
                ViewBag.Mensaje = "Error";
            }

            return View(detalleMetodoPagoDTO);
        }

        // GET: MetodoPagoController/Create
        public ActionResult Create()
        {
            return View();
        }

        // POST: MetodoPagoController/Create
        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult Create(MetodoPagoDTO metodoPagoDTO)
        {
            try
            {
                if (ModelState.IsValid)
                {
                    CUAltaMetodoPago.Ejecutar(metodoPagoDTO);
                    return RedirectToAction(nameof(Index));

                }
                else
                {
                    ViewBag.Mensaje = "Datos Incorrectos";
                }

            }
            catch (MetodoPagoException ue)
            {
                ViewBag.Mensaje = ue.Message;
            }
            catch (ArgumentNullException ex)
            {
                ViewBag.Mensaje = ex.Message;
            }
            catch (Exception ex)
            {
                ViewBag.Mensaje = "Error";
            }
            return View();
        }

        // GET: MetodoPagoController/Edit/5
        public ActionResult Edit(int id)
        {
            return View();
        }

        // POST: MetodoPagoController/Edit/5
        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult Edit(int id, IFormCollection collection)
        {
            try
            {
                return RedirectToAction(nameof(Index));
            }
            catch
            {
                return View();
            }
        }

        // GET: MetodoPagoController/Delete/5
        public ActionResult Delete(int id)
        {
            return View();
        }

        // POST: MetodoPagoController/Delete/5
        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult Delete(int id, IFormCollection collection)
        {
            try
            {
                return RedirectToAction(nameof(Index));
            }
            catch
            {
                return View();
            }
        }
    }
}

***********************************
Archivo: PagoController.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\Presentacion\Controllers\PagoController.cs
***********************************
using CasosDeUso.DTOs.PagoDTO;
using CasosDeUso.DTOs.PagoRecurrenteDTO;
using CasosDeUso.DTOs.PagoUnicoDTO;
using CasosDeUso.InterfacesCU.ICUAuditoria;
using CasosDeUso.InterfacesCU.ICUListadoMetodoPago;
using CasosDeUso.InterfacesCU.ICUPago;
using CasosDeUso.InterfacesCU.ICUTipoGasto;
using CasosDeUso.InterfacesCU.ICUUsuario;
using ExcepcionesPropias.ExcepcionesEntidades;
using LogicaAplicacion.CasosUso.CUPago;
using LogicaNegocio.EntidadesNegocio;
using Microsoft.AspNetCore.Http;
using Microsoft.AspNetCore.Mvc;

namespace Presentacion.Controllers
{
    public class PagoController : Controller
    {
        public ICUAltaPagoUnico CUAltaPagoUnico { get; set; }
        public ICUAltaPagoRecurrente CUAltaPagoRecurrente { get; set; }
        public ICUListadoTipoGasto CUListadoTipoGasto { get; set; }
        public ICUListadoMetodoPago CUListadoMetodoPago { get; set; }
        public ICUListadoUsuarios CUListadoUsuario { get; set; }
        public ICUListadoPago CUListadoPago { get; set; }
        public ICUAltaAuditoria CUAltaAuditoria { get; set; }
        public ICUFiltrarPagosXFecha CUFiltrarPagoXFecha { get; set; }
        public ICUBuscarPagoPorValorMayorA CUBuscarPagoPorValorMayorA { get; set; }
        public ICUBuscarPagoPorId CUBuscarPagoPorId { get; set; }



        public PagoController(ICUAltaPagoUnico cuAltaPagoUnico, ICUListadoTipoGasto cuListadoTipoGasto,
            ICUListadoMetodoPago cuListadoMetodoPago, ICUListadoUsuarios cuListadoUsuarios, ICUAltaPagoRecurrente cuAltaPagoRecurrente,
            ICUListadoPago cuListadoPago, ICUAltaAuditoria cuAltaAuditoria,ICUFiltrarPagosXFecha cuFiltrarPagoXFecha,
            ICUBuscarPagoPorValorMayorA cuBuscarPagoPorValorMayorA, ICUBuscarPagoPorId cuBuscarPagoPorId)
        {
            CUAltaPagoUnico = cuAltaPagoUnico;
            CUAltaPagoRecurrente = cuAltaPagoRecurrente;
            CUListadoTipoGasto = cuListadoTipoGasto;
            CUListadoMetodoPago = cuListadoMetodoPago;
            CUListadoUsuario = cuListadoUsuarios;
            CUListadoPago = cuListadoPago;
            CUAltaAuditoria = cuAltaAuditoria;
            CUFiltrarPagoXFecha = cuFiltrarPagoXFecha;
            CUBuscarPagoPorValorMayorA = cuBuscarPagoPorValorMayorA;
            CUBuscarPagoPorId = cuBuscarPagoPorId;

        }


        // GET: PagoController
        public ActionResult Index()
        {
            IEnumerable<ListadoPagoDTO> pagos = new List<ListadoPagoDTO>();
            if (HttpContext.Session.GetString("Rol") == null || (HttpContext.Session.GetString("Rol") != "Gerente"))
            {
                return RedirectToAction("Index", "Home");
            }
            try
            {
                pagos = CUListadoPago.Ejecutar();
            }
            catch (Exception ex)
            {
                ViewBag.Mensaje = "Error";
            }
            return View(pagos);
        }

        // GET: PagoController/Details/5
        public ActionResult Details(int id)
        {
            BuscarPagoPorIdDTO detallePago = new BuscarPagoPorIdDTO();
            if (HttpContext.Session.GetString("Rol") == null || (HttpContext.Session.GetString("Rol") != "Gerente"))
            {
                return RedirectToAction("Index", "Home");
            }
            try
            {
                if (id > 0)
                {
                    detallePago = CUBuscarPagoPorId.Ejecutar(id);
                }
                else
                {
                    throw new ArgumentNullException("El id no es correcto");
                }
            }
            catch (ArgumentNullException ex)
            {
                ViewBag.Mensaje = ex.Message;
            }
            catch (PagoException ex)
            {
                ViewBag.Mensaje = ex.Message;
            }
            catch(Exception ex)
            {
                ViewBag.Mensaje = "Error";
            }

            return View(detallePago);
        }

        // POST /Filtrar: filtra por fecha 
        [HttpPost]
        [ValidateAntiForgeryToken]
        public IActionResult Filtrar(DateTime fecha)
        {

            
            IEnumerable<ListaFiltroPagoXFecha> listaPagosFiltrada = new List<ListaFiltroPagoXFecha>();
            if (HttpContext.Session.GetString("Rol") == null || (HttpContext.Session.GetString("Rol") != "Gerente"))
            {
                return RedirectToAction("Index", "Home");
            }
            // Guardo ambas representaciones
            ViewBag.FechaSeleccionada = fecha.ToString("yyyy-MM-dd");   // para el <input type="date">
            ViewBag.FechaSeleccionadaDisplay = fecha.ToString("dd/MM/yyyy"); // para el H1
            try
            {
                if (fecha != null)
                {
                    listaPagosFiltrada = CUFiltrarPagoXFecha.Ejecutar(fecha);
                }
                else
                {
                    throw new ArgumentNullException("La fecha no es correcta");
                }

            }
            catch (ArgumentNullException ex)
            {
                ViewBag.Mensaje = ex.Message;
            }
            catch (PagoException ex)
            {
                ViewBag.Mensaje = ex.Message;
            }
            catch (Exception ex)
            {
                ViewBag.Mensaje = "Error";
            }

            return View(listaPagosFiltrada);
        }


        // GET: muestra el formulario y/o resultados si viene ?valor=
        [HttpGet]
        public ActionResult PagoUnicoPorMontoMayorA(decimal? valor)
        {
            IEnumerable<ListaPagoUnicoMayorADTO> listadoPagos = new List<ListaPagoUnicoMayorADTO>();
            if (HttpContext.Session.GetString("Rol") == null || (HttpContext.Session.GetString("Rol") != "Gerente"))
            {
                return RedirectToAction("Index", "Home");
            }
            try
            {
                if (valor.HasValue && valor.Value > 0)
                {
                    listadoPagos = CUBuscarPagoPorValorMayorA.Ejecutar(valor.Value);
                }
            }
            catch(PagoException ex) 
            {
                ViewBag.Mensaje = ex.Message;
            }
            catch(Exception ex)
            {
                ViewBag.Mensaje = "Error";
            }
            return View(listadoPagos); 
        }


        // POST: PagoController/PagoUnico/
        [HttpPost]
        public ActionResult PagoUnicoPorMontoMayorA(decimal valor)
        {
            if (HttpContext.Session.GetString("Rol") == null || (HttpContext.Session.GetString("Rol") != "Gerente"))
            {
                return RedirectToAction("Index", "Home");
            }
            try
            {
                if (valor <= 0)
                {
                    TempData["Mensaje"] = "El monto no es correcto";
                    return RedirectToAction(nameof(PagoUnicoPorMontoMayorA));
                }
            }
            catch (PagoException ex)
            {
                ViewBag.Mensaje = ex.Message;
            }
            catch (Exception ex)
            {
                ViewBag.Mensaje = "Error";
            }

            // Redirige al GET 
            return RedirectToAction(nameof(PagoUnicoPorMontoMayorA), new { valor });
        }


        //GET de Pago recurrente
        public ActionResult PagoRecurrente()
        {
            PagoRecurrenteDTO pagoRecurrenteDTO = new PagoRecurrenteDTO();
            
            try
            {
                pagoRecurrenteDTO.TipoGastos = CUListadoTipoGasto.Ejecutar();
                pagoRecurrenteDTO.Usuarios = CUListadoUsuario.Ejecutar();
            }
            catch (Exception ex)
            {
                ViewBag.Mensaje = "Error";
            }

            return View(pagoRecurrenteDTO);
        }

        //POST de Pago Recurrente
        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult PagoRecurrente(PagoRecurrenteDTO pagoRecurrenteDTO)
        {
            pagoRecurrenteDTO.TipoGastos = CUListadoTipoGasto.Ejecutar();
            pagoRecurrenteDTO.Usuarios = CUListadoUsuario.Ejecutar();
            try
            {
                if (ModelState.IsValid)
                {
                    CUAltaPagoRecurrente.Ejecutar(pagoRecurrenteDTO);

                    if (HttpContext.Session.GetString("Rol") == "Empleado" || HttpContext.Session.GetString("Rol") == null)
                    {
                        return RedirectToAction("Index", "Home");
                    }
                    if (HttpContext.Session.GetString("Rol") == "Gerente")
                    {
                        return RedirectToAction("Index", "Pago");
                    }
                    if (HttpContext.Session.GetString("Rol") == "Administrador")
                    {
                        return RedirectToAction("Index", "Home");
                    }
                }
            }
            catch (PagoException ex)
            {
                ViewBag.Mensaje = ex.Message;
            }
            catch (ArgumentNullException ex)
            {
                ViewBag.Mensaje = ex.Message;
            }
            catch (Exception ex)
            {
                ViewBag.Mensaje = "Error";
            }
            return View(pagoRecurrenteDTO);
        }




        // GET: PagoController/PagoUnico/Create
        public ActionResult PagoUnico()
        {
            PagoUnicoDTO pagoUnicoDTO = new PagoUnicoDTO();
           
            try
            {
                pagoUnicoDTO.TipoGastos = CUListadoTipoGasto.Ejecutar();
                pagoUnicoDTO.Usuarios = CUListadoUsuario.Ejecutar();
            }
            //catch (ArgumentNullException ex)
            //{
            //    ViewBag.Mensaje = ex.Message;
            //}
            catch (Exception ex)
            {
                ViewBag.Mensaje = "Error";
            }
            return View(pagoUnicoDTO);
        }



        // POST: PagoController/Create
        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult PagoUnico(PagoUnicoDTO pagoUnicoDTO)
        {
            pagoUnicoDTO.TipoGastos = CUListadoTipoGasto.Ejecutar();
            //pagoUnicoDTO.MetodoPagos = CUListadoMetodoPago.Ejecutar();
            pagoUnicoDTO.Usuarios = CUListadoUsuario.Ejecutar();
            try
            {
                if (ModelState.IsValid)
                {
                    CUAltaPagoUnico.Ejecutar(pagoUnicoDTO);

                    if (HttpContext.Session.GetString("Rol") == "Empleado" || HttpContext.Session.GetString("Rol") == null)
                    {
                        return RedirectToAction("Index", "Home");
                    }
                    if (HttpContext.Session.GetString("Rol") == "Gerente")
                    {
                        return RedirectToAction("Index", "Pago");
                    }
                    if (HttpContext.Session.GetString("Rol") == "Administrador")
                    {
                        return RedirectToAction("Index", "Home");
                    }
                }
            }
            catch (PagoException ex)
            {
                ViewBag.Mensaje = ex.Message;
            }
            catch (ArgumentNullException ex)
            {
                ViewBag.Mensaje = ex.Message;
            }
            catch (Exception ex)
            {
                ViewBag.Mensaje = "Error";
            }

            return View(pagoUnicoDTO);
        }

        // GET: PagoController/Edit/5
        public ActionResult Edit(int id)
        {
            if (HttpContext.Session.GetString("Rol") == null || (HttpContext.Session.GetString("Rol") != "Gerente"))
            {
                return RedirectToAction("Index", "Home");
            }
            return View();
        }

        // POST: PagoController/Edit/5
        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult Edit(int id, IFormCollection collection)
        {
            if (HttpContext.Session.GetString("Rol") == null || (HttpContext.Session.GetString("Rol") != "Gerente"))
            {
                return RedirectToAction("Index", "Home");
            }
            try
            {
                return RedirectToAction(nameof(Index));
            }
            catch
            {
                return View();
            }
        }

        // GET: PagoController/Delete/5
        public ActionResult Delete(int id)
        {
            if (HttpContext.Session.GetString("Rol") == null || (HttpContext.Session.GetString("Rol") != "Gerente"))
            {
                return RedirectToAction("Index", "Home");
            }
            return View();
        }

        // POST: PagoController/Delete/5
        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult Delete(int id, IFormCollection collection)
        {
            if (HttpContext.Session.GetString("Rol") == null || (HttpContext.Session.GetString("Rol") != "Gerente"))
            {
                return RedirectToAction("Index", "Home");
            }
            try
            {
                return RedirectToAction(nameof(Index));
            }
            catch
            {
                return View();
            }
        }
    }
}

***********************************
Archivo: RolController.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\Presentacion\Controllers\RolController.cs
***********************************
using CasosDeUso.DTOs.RolDTO;
using CasosDeUso.InterfacesCU.ICURol;
using ExcepcionesPropias.ExcepcionesEntidades;
using Microsoft.AspNetCore.Http;
using Microsoft.AspNetCore.Mvc;

namespace Presentacion.Controllers
{
    public class RolController : Controller
    {
        public ICUAltaRol CUAltaRol {  get; set; }
        public ICUListarRol CUListarRol { get; set; }


        public RolController(ICUAltaRol cuAltaRol, ICUListarRol cuListarRol )
        {
            CUAltaRol = cuAltaRol;
            CUListarRol = cuListarRol;
        }



        // GET: RolController
        public ActionResult Index()
        {
            IEnumerable<ListarRolParaAltaUsuarioDTO> listarRolDTOs = new List<ListarRolParaAltaUsuarioDTO>();

            try
            {
                listarRolDTOs = CUListarRol.Ejecutar();
            }
            catch (Exception ex)
            {
                ViewBag.Mensaje = "Error";
            }

            return View(listarRolDTOs);
        }

        // GET: RolController/Details/5
        public ActionResult Details(int id)
        {
            return View();
        }

        // GET: RolController/Create
        public ActionResult Create()
        {

            return View();
        }

        // POST: RolController/Create
        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult Create(AltaRolDTO rolDTO)
        {
            try
            {
                if (ModelState.IsValid)
                {
                    CUAltaRol.Ejecutar(rolDTO);
                    return RedirectToAction(nameof(Index));
                }
                else
                {
                    ViewBag.Mensaje = "Datos incorrectos";
                }

            }
            catch (ArgumentNullException ex)
            {
                ViewBag.Mensaje = ex.Message;
            }
            catch (RolException ex)
            {
                ViewBag.Mensaje = ex.Message;
            }
            catch (Exception ex)
            {
                ViewBag.Mensaje = "Error";
            }
            return View();
        }

        // GET: RolController/Edit/5
        public ActionResult Edit(int id)
        {
            return View();
        }

        // POST: RolController/Edit/5
        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult Edit(int id, IFormCollection collection)
        {
            try
            {
                return RedirectToAction(nameof(Index));
            }
            catch
            {
                return View();
            }
        }

        // GET: RolController/Delete/5
        public ActionResult Delete(int id)
        {
            return View();
        }

        // POST: RolController/Delete/5
        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult Delete(int id, IFormCollection collection)
        {
            try
            {
                return RedirectToAction(nameof(Index));
            }
            catch
            {
                return View();
            }
        }
    }
}

***********************************
Archivo: TipoGastoController.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\Presentacion\Controllers\TipoGastoController.cs
***********************************
using CasosDeUso.DTOs.AuditoriaDTO;
using CasosDeUso.DTOs.TipoGastoDTOs;
using CasosDeUso.InterfacesCU.CUTipoGasto;
using CasosDeUso.InterfacesCU.ICUAuditoria;
using CasosDeUso.InterfacesCU.ICUTipoGasto;
using CasosDeUso.InterfacesCU.ICUUsuario;
using ExcepcionesPropias.ExcepcionesEntidades;
using Microsoft.AspNetCore.Http;
using Microsoft.AspNetCore.Mvc;

namespace Presentacion.Controllers
{
    public class TipoGastoController : Controller
    {
        public ICUAltaTipoGasto CUAltaTipoGasto { get; set; }
        public ICUListadoTipoGasto CUListadoTipoGasto { get; set; }
        public ICUBuscarTipoGasto CUBuscarTipoGasto { get; set; }
        public ICUEliminarTipoGasto CUEliminarTipoGasto { get; set; }
        public ICUEditarTipoGasto CUEditarTipoGasto { get; set; }
        public ICUAltaAuditoria CUAltaAuditoria { get; set; }
        public ICUBuscarUsuario CUBuscarUsuario { get; set; }

        public TipoGastoController(ICUAltaTipoGasto cUAltaTipoGasto, ICUListadoTipoGasto cUListadoTipoGasto,
            ICUBuscarTipoGasto cUBuscarTipoGasto, ICUEliminarTipoGasto cUEliminarTipoGasto,
            ICUEditarTipoGasto cUEditarTipoGasto, ICUAltaAuditoria cuAltaAuditoria, ICUBuscarUsuario cuBuscarUsuario)
        {
            CUAltaTipoGasto = cUAltaTipoGasto;
            CUListadoTipoGasto = cUListadoTipoGasto;
            CUBuscarTipoGasto = cUBuscarTipoGasto;
            CUEliminarTipoGasto = cUEliminarTipoGasto;
            CUEditarTipoGasto = cUEditarTipoGasto;
            CUAltaAuditoria = cuAltaAuditoria;
            CUBuscarUsuario = cuBuscarUsuario;
        }
        // GET: TipoGastoController
        public ActionResult Index()
        {
            IEnumerable<ListadoTipoGastoDTO> ListadoTipoGastos = new List<ListadoTipoGastoDTO>();
            var rol = HttpContext.Session.GetString("Rol");
            if (string.IsNullOrEmpty(rol) || rol != "Administrador")
            {
                return RedirectToAction("Index", "Home");
            }
            try
            {
                ListadoTipoGastos = CUListadoTipoGasto.Ejecutar();
            }
            catch (Exception)
            {
                ViewBag.Mensaje = "Error";
            }

            return View(ListadoTipoGastos);
        }

        // GET: TipoGastoController/Details/5
        public ActionResult Details(int id)
        {
            DetalleTipoGastoDTO detalleTipoGasto = new DetalleTipoGastoDTO();
            var rol = HttpContext.Session.GetString("Rol");
            if (string.IsNullOrEmpty(rol) || rol != "Administrador")
            {
                return RedirectToAction("Index", "Home");
            }
            try
            {
                if (id > 0)
                {
                    detalleTipoGasto = CUBuscarTipoGasto.Ejecutar(id);
                }
                else
                {
                    throw new ArgumentException("El id no es correcto");
                }
            }
            catch (GastoException ex)
            {
                ViewBag.Mensaje = ex.Message;
            }
            catch (ArgumentNullException ex)
            {
                ViewBag.Mensaje = ex.Message;
            }
            catch (Exception)
            {
                ViewBag.Mensaje = "Error";
            }

            return View(detalleTipoGasto);
        }

        // GET: TipoGastoController/Create
        public ActionResult Create()
        {
            var rol = HttpContext.Session.GetString("Rol");
            if (string.IsNullOrEmpty(rol) || rol != "Administrador")
            {
                return RedirectToAction("Index", "Home");
            }
            return View();
        }

        // POST: TipoGastoController/Create
        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult Create(TipoGastoDTO tipoGastoDTO)
        {
            var rol = HttpContext.Session.GetString("Rol");
            if (string.IsNullOrEmpty(rol) || rol != "Administrador")
            {
                return RedirectToAction("Index", "Home");
            }

            try
            {
                if (ModelState.IsValid)
                {
                    CUAltaTipoGasto.Ejecutar(tipoGastoDTO);

                    //Aca empieza mi Auditoria
                    AuditoriaDTO auditoriaDTO = new AuditoriaDTO();

                    int IdUsuario = int.Parse(HttpContext.Session.GetString("Id"));
                    string NombreUsuario = HttpContext.Session.GetString("NombreUsuario");
                    var NombreTipoGasto = tipoGastoDTO.Nombre;
                    var DescTipoGasto = tipoGastoDTO.Descripcion;
                    var Fecha = DateTime.Now;
                    var Accion = "Alta";

                    auditoriaDTO.UsuarioId = IdUsuario;
                    auditoriaDTO.NombreUsuario = NombreUsuario;
                    auditoriaDTO.TipoGastoNombre = NombreTipoGasto;
                    auditoriaDTO.DescripcionTipoGasto = DescTipoGasto;
                    auditoriaDTO.Fecha = Fecha;
                    auditoriaDTO.Accion = Accion;

                    CUAltaAuditoria.Ejecutar(auditoriaDTO);

                    return RedirectToAction(nameof(Index));
                }
                else
                {
                    ViewBag.Mensaje = "Datos incorrectos";
                }
            }
            catch(ArgumentNullException ex)
            {
                ViewBag.Mensaje = ex.Message;
            }
            catch (GastoException ge)
            {
                ViewBag.Mensaje = ge.Message;
            }
            catch (Exception)
            {
                ViewBag.Mensaje = "Error";
            }
            return View();

        }

        // GET: TipoGastoController/Edit/5
        public ActionResult Edit(int id)
        {
            DetalleTipoGastoDTO detalleTipoGasto = new DetalleTipoGastoDTO();
            var rol = HttpContext.Session.GetString("Rol");
            if (string.IsNullOrEmpty(rol) || rol != "Administrador")
            {
                return RedirectToAction("Index", "Home");
            }
            try
            {
                if (id > 0)
                {
                    detalleTipoGasto = CUBuscarTipoGasto.Ejecutar(id);
                }
                else
                {
                    throw new ArgumentException("El id no es correcto");
                }
            }
            catch (GastoException ex)
            {
                ViewBag.Mensaje = ex.Message;
            }
            catch (ArgumentNullException ex)
            {
                ViewBag.Mensaje = ex.Message;
            }
            catch (Exception)
            {
                ViewBag.Mensaje = "Error";
            }

            return View(detalleTipoGasto);
        }

        // POST: TipoGastoController/Edit/5
        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult Edit(int id, DetalleTipoGastoDTO detalleTipoGasto)
        {
            var rol = HttpContext.Session.GetString("Rol");
            if (string.IsNullOrEmpty(rol) || rol != "Administrador")
            {
                return RedirectToAction("Index", "Home");
            }
            try
            {
                if (id > 0 && ModelState.IsValid)
                {

                    CUEditarTipoGasto.Ejecutar(detalleTipoGasto, id);

                    //Aca empieza mi Auditoria
                    AuditoriaDTO auditoriaDTO = new AuditoriaDTO();

                    int IdUsuario = int.Parse(HttpContext.Session.GetString("Id"));
                    string NombreUsuario = HttpContext.Session.GetString("NombreUsuario");
                    var NombreTipoGasto = detalleTipoGasto.Nombre;
                    var DescTipoGasto = detalleTipoGasto.Descripcion;
                    var Fecha = DateTime.Now;
                    var Accion = "Edit";

                    auditoriaDTO.UsuarioId = IdUsuario;
                    auditoriaDTO.NombreUsuario = NombreUsuario;
                    auditoriaDTO.TipoGastoNombre = NombreTipoGasto;
                    auditoriaDTO.DescripcionTipoGasto = DescTipoGasto;
                    auditoriaDTO.Fecha = Fecha;
                    auditoriaDTO.Accion = Accion;

                    CUAltaAuditoria.Ejecutar(auditoriaDTO);

                    return RedirectToAction(nameof(Index));
                }
            }
            catch (ArgumentException ex)
            {
                ViewBag.Mensaje = ex.Message;
            }
            catch (GastoException ex)
            {
                ViewBag.Mensaje = ex.Message;
            }
            catch (Exception)
            {
                ViewBag.Mensaje = "Error";
            }
            return View(detalleTipoGasto);
        }

        // GET: TipoGastoController/Delete/5
        public ActionResult Delete(int id)
        {
            DetalleTipoGastoDTO detalleTipoGasto = new DetalleTipoGastoDTO();
            var rol = HttpContext.Session.GetString("Rol");
            if (string.IsNullOrEmpty(rol) || rol != "Administrador")
            {
                return RedirectToAction("Index", "Home");
            }
            try
            {
                if (id > 0)
                {
                    detalleTipoGasto = CUBuscarTipoGasto.Ejecutar(id);
                }
                else
                {
                    throw new ArgumentException("El id no es correcto");
                }
            }
            catch (GastoException ex)
            {
                ViewBag.Mensaje = ex.Message;
            }
            catch (ArgumentNullException ex)
            {
                ViewBag.Mensaje = ex.Message;
            }
            catch (Exception)
            {
                ViewBag.Mensaje = "Error";
            }

            return View(detalleTipoGasto);
        }

        // POST: TipoGastoController/Delete/5
        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult Delete(int id, DetalleTipoGastoDTO detalleTipoGasto)
        {
            var rol = HttpContext.Session.GetString("Rol");
            if (string.IsNullOrEmpty(rol) || rol != "Administrador")
            {
                return RedirectToAction("Index", "Home");
            }
            //Validación básica
            if (id <= 0)
            {
                ViewBag.Mensaje = "El id no es correcto";
                return View(detalleTipoGasto);
            }

            //Me guardo l estado previo (lo que será eliminado)
            DetalleTipoGastoDTO antes;
            try
            {
                antes = CUBuscarTipoGasto.Ejecutar(id);
                if (antes == null)
                {
                    ViewBag.Mensaje = "No se encontró el TipoGasto";
                    return View(detalleTipoGasto);
                }
            }
            catch (Exception ex)
            {
                ViewBag.Mensaje = "Error";
                return View(detalleTipoGasto);
            }

            //Intento de eliminación con auditoría de resultado
            bool eliminadoOk = false;
            string? error = null;

            try
            {
                CUEliminarTipoGasto.Ejecutar(id);
                eliminadoOk = true;
                return RedirectToAction(nameof(Index));
            }
            catch (ArgumentNullException ex)
            {
                ViewBag.Mensaje = ex.Message;
            }
            catch (GastoException ex)
            {
                ViewBag.Mensaje = ex.Message;
            }
            catch (Exception)
            {
                ViewBag.Mensaje = "Error";
            }
            
            finally
            {
                //Mi Auditoria
                try
                {

                    //Aca empieza mi Auditoria
                    AuditoriaDTO auditoriaDTO = new AuditoriaDTO();

                    int IdUsuario = int.Parse(HttpContext.Session.GetString("Id"));
                    string NombreUsuario = HttpContext.Session.GetString("NombreUsuario");
                    var NombreTipoGasto = antes.Nombre;
                    var DescTipoGasto = antes.Descripcion;
                    var Fecha = DateTime.Now;
                    var Accion = "Delete";

                    auditoriaDTO.UsuarioId = IdUsuario;
                    auditoriaDTO.NombreUsuario = NombreUsuario;
                    auditoriaDTO.TipoGastoNombre = NombreTipoGasto;
                    auditoriaDTO.DescripcionTipoGasto = DescTipoGasto;
                    auditoriaDTO.Fecha = Fecha;
                    auditoriaDTO.Accion = Accion;

                    CUAltaAuditoria.Ejecutar(auditoriaDTO);
                }
                catch
                {
                    // No tiro excepción desde la auditoría
                }
            }
        return View(detalleTipoGasto);
        }
    }
}

***********************************
Archivo: UsuarioController.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\Presentacion\Controllers\UsuarioController.cs
***********************************
using CasosDeUso.DTOs.EquipoDTO;
using CasosDeUso.DTOs.RolDTO;
using CasosDeUso.DTOs.UsuarioDTOs;
using CasosDeUso.InterfacesCU.ICUEquipo;
using CasosDeUso.InterfacesCU.ICURol;
using CasosDeUso.InterfacesCU.ICUUsuario;
using ExcepcionesPropias.ExcepcionesEntidades;
using LogicaAplicacion.CasosUso.CUUsuario;
using LogicaNegocio.EntidadesNegocio;
using LogicaNegocio.InterfacesRepositorio;
using Microsoft.AspNetCore.Http;
using Microsoft.AspNetCore.Mvc;

namespace Presentacion.Controllers
{
    public class UsuarioController : Controller
    {
        public ICUAltaUsuario CUAltaUsuario { get; set; }
        public ICUBuscarUsuario CUBuscarUsuario { get; set; }
        public ICUListadoUsuarios CUListadoUsuarios { get; set; }
        public ICUListarEquipo CUListarEquipo { get; set; }
        public ICUListadoRolParaLogin CUListadoRolParaLogin { get; set; }
        public ICUListarRol CUListarRol { get; set; }

        public UsuarioController(ICUAltaUsuario cuAltaUsuario, ICUBuscarUsuario cuBuscarUsuario,
            ICUListadoUsuarios cUListadoUsuarios, ICUListarEquipo cuListarEquipo, ICUListadoRolParaLogin cuListadoRolParaLogin, ICUListarRol cUListarRol)
        {
            CUAltaUsuario = cuAltaUsuario;
            CUBuscarUsuario = cuBuscarUsuario;
            CUListadoUsuarios = cUListadoUsuarios;
            CUListarEquipo = cuListarEquipo;
            CUListadoRolParaLogin = cuListadoRolParaLogin;
            CUListarRol = cUListarRol;
        }


        // GET: UsuarioController
        public ActionResult Index()
        {
            IEnumerable<ListadoUsuarioDTO> listadoUausrios = new List<ListadoUsuarioDTO>();
            var rol = HttpContext.Session.GetString("Rol");
            if (string.IsNullOrEmpty(rol) || !(rol == "Gerente" || rol == "Administrador"))
            {
                return RedirectToAction("Index", "Home");
            }
            try
            {
                listadoUausrios = CUListadoUsuarios.Ejecutar();

            }
            catch (Exception ex)
            {
                ViewBag.Mensaje = "Error";
            }

            return View(listadoUausrios);

        }


        public IActionResult Login()
        {
            return View();
        }

        [HttpPost]
        public IActionResult Login(UsuarioLoginDTO usuarioLoginDTO)
        {
            try
            {
                if (ModelState.IsValid)
                {
                    DetalleLoginUsuarioDTO usuLogueado = CUBuscarUsuario.Ejecutar(usuarioLoginDTO);
                    if (usuLogueado != null)
                    {
                        HttpContext.Session.SetString("Id", usuLogueado.Id.ToString());
                        HttpContext.Session.SetString("NombreUsuario", usuLogueado.Nombre);
                        HttpContext.Session.SetString("Rol", usuLogueado.Rol);
                        HttpContext.Session.SetString("Mail", usuLogueado.Mail);

                    }
                        return RedirectToAction("Index", "Home");
                }
            }
            catch (UsuarioException ue)
            {
                ViewBag.Mensaje = ue.Message;
            }
            catch (ArgumentNullException ex)
            {
                ViewBag.Mensaje = ex.Message;
            }
            catch (Exception ex)
            {
                ViewBag.Mensaje = "Error";
            }
            return View();
        }


        public IActionResult Logout()
        {
            HttpContext.Session.Clear();

            // Volver al Login (o Home)
            return RedirectToAction("Login", "Usuario");
        }


        // GET: UsuarioController/Details/5
        public ActionResult Details(int id)
        {
            var rol = HttpContext.Session.GetString("Rol");
            if (string.IsNullOrEmpty(rol) || !(rol == "Gerente" || rol == "Administrador"))
            {
                return RedirectToAction("Index", "Home");
            }
            return View();
        }

        // GET: UsuarioController/Create
        public ActionResult Create()
        {
            AltaUsuarioDTO usuarioDTO = new AltaUsuarioDTO();
            var rol = HttpContext.Session.GetString("Rol");
            if (string.IsNullOrEmpty(rol) || !(rol == "Gerente" || rol == "Administrador"))
            {
                return RedirectToAction("Index", "Home");
            }

            try
            {
                usuarioDTO.RolesDisponibles = CUListarRol.Ejecutar();
                usuarioDTO.Equipos = CUListarEquipo.Ejecutar();

            }
            catch (Exception ex)
            {
                ViewBag.Mensaje = "Error";
            }


            return View(usuarioDTO);
        }

        // POST: UsuarioController/Create
        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult Create(AltaUsuarioDTO usuarioDTO)
        {
            var rol = HttpContext.Session.GetString("Rol");
            if (string.IsNullOrEmpty(rol) || !(rol == "Gerente" || rol == "Administrador"))
            {
                return RedirectToAction("Index", "Home");
            }
            usuarioDTO.RolesDisponibles = CUListarRol.Ejecutar();
            usuarioDTO.Equipos = CUListarEquipo.Ejecutar();
            try
            {
                if (ModelState.IsValid)
                {
                    CUAltaUsuario.Ejecutar(usuarioDTO);
                    return RedirectToAction(nameof(Index));
                }
            }
            catch (UsuarioException ue)
            {
                ViewBag.Mensaje = ue.Message;
            }
            catch (ArgumentNullException ex)
            {
                ViewBag.Mensaje = ex.Message;
            }
            catch (Exception ex)
            {
                ViewBag.Mensaje = "Error";
            }

            return RedirectToAction(nameof(Index));
        }


        // GET: UsuarioController/Edit/5
        public ActionResult Edit(int id)
        {
            var rol = HttpContext.Session.GetString("Rol");
            if (string.IsNullOrEmpty(rol) || !(rol == "Gerente" || rol == "Administrador"))
            {
                return RedirectToAction("Index", "Home");
            }
            return View();
        }

        // POST: UsuarioController/Edit/5
        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult Edit(int id, IFormCollection collection)
        {
            var rol = HttpContext.Session.GetString("Rol");
            if (string.IsNullOrEmpty(rol) || !(rol == "Gerente" || rol == "Administrador"))
            {
                return RedirectToAction("Index", "Home");
            }
            try
            {
                return RedirectToAction(nameof(Index));
            }
            catch
            {
                return View();
            }
        }

        // GET: UsuarioController/Delete/5
        public ActionResult Delete(int id)
        {
            var rol = HttpContext.Session.GetString("Rol");
            if (string.IsNullOrEmpty(rol) || !(rol == "Gerente" || rol == "Administrador"))
            {
                return RedirectToAction("Index", "Home");
            }
            return View();
        }

        // POST: UsuarioController/Delete/5
        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult Delete(int id, IFormCollection collection)
        {
            var rol = HttpContext.Session.GetString("Rol");
            if (string.IsNullOrEmpty(rol) || !(rol == "Gerente" || rol == "Administrador"))
            {
                return RedirectToAction("Index", "Home");
            }
            try
            {
                return RedirectToAction(nameof(Index));
            }
            catch
            {
                return View();
            }
        }
    }
}

***********************************
Archivo: ErrorViewModel.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\Presentacion\Models\ErrorViewModel.cs
***********************************
namespace Presentacion.Models
{
    public class ErrorViewModel
    {
        public string? RequestId { get; set; }

        public bool ShowRequestId => !string.IsNullOrEmpty(RequestId);
    }
}

***********************************
Archivo: PagoWebAPIController.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\WebAPI\Controllers\PagoWebAPIController.cs
***********************************
using CasosDeUso.InterfacesCU.ICUPago;
using ExcepcionesPropias.ExcepcionesEntidades;
using Microsoft.AspNetCore.Http.HttpResults;
using Microsoft.AspNetCore.Mvc;

// For more information on enabling Web API for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860

namespace WebAPI.Controllers
{
    [Route("api/[controller]")]
    [ApiController]
    public class PagoWebAPIController : ControllerBase
    {
        public ICUListadoPago CUListadoPago { get; set; }
        ICUBuscarPagoPorId CUBuscarPagoPorId { get; set; }
        
        public PagoWebAPIController(ICUListadoPago cuListadoPago, ICUBuscarPagoPorId cuBuscarPagoPorId)
        {
            CUListadoPago = cuListadoPago;
            CUBuscarPagoPorId = cuBuscarPagoPorId;
        }
        /// <summary>
        /// Permite obtener la lista de Pago
        /// </summary>
        /// <returns></returns>
        [ProducesResponseType(StatusCodes.Status200OK)]
        [ProducesResponseType(StatusCodes.Status500InternalServerError)]

        // GET: api/<PagoWebAPIController>
        [HttpGet]
        public IActionResult Get()
        {
            try
            {
                return Ok(CUListadoPago.Ejecutar());
            }
            catch (Exception ex)
            {
                return StatusCode(500, "Error");
            }
        }
        /// <summary>
        /// Permite obtener los datos de un Pago por Id del parámetro
        /// </summary>
        /// <param name="id"></param>
        /// <returns></returns>
        /// 

        [ProducesResponseType(StatusCodes.Status200OK)]
        [ProducesResponseType(StatusCodes.Status500InternalServerError)]
        [ProducesResponseType(StatusCodes.Status400BadRequest)]
        [ProducesResponseType(StatusCodes.Status404NotFound)]
        // GET api/<PagoWebAPIController>/5
        [HttpGet("{id}")]
        public IActionResult Get(int id)
        {
            try
            {
                if(id <= 0)
                {
                    return BadRequest("El id no es correcto");
                }
                    return Ok(CUBuscarPagoPorId.Ejecutar(id));
            }
            catch(ArgumentNullException ex)
            {
                return BadRequest(ex.Message);
            }
            catch(PagoException ex)
            {
                return NotFound(ex.Message);
            }
            catch (Exception ex)
            {
                return StatusCode(500, "Error");
            }

        }

        // POST api/<PagoWebAPIController>
        [HttpPost]
        public void Post([FromBody] string value)
        {
        }

        // PUT api/<PagoWebAPIController>/5
        [HttpPut("{id}")]
        public void Put(int id, [FromBody] string value)
        {
        }

        // DELETE api/<PagoWebAPIController>/5
        [HttpDelete("{id}")]
        public void Delete(int id)
        {
        }
    }
}

***********************************
Archivo: WeatherForecastController.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\WebAPI\Controllers\WeatherForecastController.cs
***********************************
using Microsoft.AspNetCore.Mvc;

namespace WebAPI.Controllers
{
    [ApiController]
    [Route("[controller]")]
    public class WeatherForecastController : ControllerBase
    {
        private static readonly string[] Summaries = new[]
        {
            "Freezing", "Bracing", "Chilly", "Cool", "Mild", "Warm", "Balmy", "Hot", "Sweltering", "Scorching"
        };

        private readonly ILogger<WeatherForecastController> _logger;

        public WeatherForecastController(ILogger<WeatherForecastController> logger)
        {
            _logger = logger;
        }

        [HttpGet(Name = "GetWeatherForecast")]
        public IEnumerable<WeatherForecast> Get()
        {
            return Enumerable.Range(1, 5).Select(index => new WeatherForecast
            {
                Date = DateOnly.FromDateTime(DateTime.Now.AddDays(index)),
                TemperatureC = Random.Shared.Next(-20, 55),
                Summary = Summaries[Random.Shared.Next(Summaries.Length)]
            })
            .ToArray();
        }
    }
}

***********************************
Archivo: AuditoriaDTO.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\CasosDeUso\DTOs\AuditoriaDTO\AuditoriaDTO.cs
***********************************
using CasosDeUso.DTOs.TipoGastoDTOs;
using CasosDeUso.DTOs.UsuarioDTOs;
using LogicaNegocio.EntidadesNegocio;
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace CasosDeUso.DTOs.AuditoriaDTO
{
    public class AuditoriaDTO
    {
        public string Accion { get; set; }
        [DisplayName("Usuario")]
        public int UsuarioId { get; set; }
        [DisplayName("Nombre de Usuario")]
        public string NombreUsuario { get; set; }
        [DisplayName("Rol de Usuario")]
        public string Rol { get; set; }
        [DisplayName("Nombre de Tipo de Gasto")]
        public string TipoGastoNombre { get; set; }
        [DisplayName("Descripcion de Tipo de Gasto")]
        public string DescripcionTipoGasto { get; set; }
        public DateTime Fecha { get; set; }
    }
}

***********************************
Archivo: EquipoDTOs.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\CasosDeUso\DTOs\EquipoDTO\EquipoDTOs.cs
***********************************
using System;
using System.Collections.Generic;
using System.ComponentModel.DataAnnotations;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace CasosDeUso.DTOs.EquipoDTO
{
    public class EquipoDTOs
    {
        public int Id { get; set; }
        [Required(ErrorMessage = "El Nombre es obligatorio")]
        public string Nombre { get; set; }
    }
}

***********************************
Archivo: DetalleMetodoPagoDTO.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\CasosDeUso\DTOs\MetodoPagoDTO\DetalleMetodoPagoDTO.cs
***********************************
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace CasosDeUso.DTOs.MetodoPagoDTO
{
    public class DetalleMetodoPagoDTO
    {
        [DisplayName("Identificador")]
        public int Id { get; set; }
        public string Descripcion { get; set; }
    }
}

***********************************
Archivo: ListadoMetodoPagoDTO.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\CasosDeUso\DTOs\MetodoPagoDTO\ListadoMetodoPagoDTO.cs
***********************************
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace CasosDeUso.DTOs.MetodoPagoDTO
{
    public class ListadoMetodoPagoDTO
    {
        [DisplayName("Identificador")]
        public int Id { get; set; }
        public string Descripcion { get; set; }
    }
}

***********************************
Archivo: MetodoPagoDTO.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\CasosDeUso\DTOs\MetodoPagoDTO\MetodoPagoDTO.cs
***********************************
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace CasosDeUso.DTOs.MetodoPagoDTO
{

    public class MetodoPagoDTO
    {

        public int Id { get; private set; }
        public string Descripcion { get; set; }
    }
}

***********************************
Archivo: BuscarPagoPorIdDTO.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\CasosDeUso\DTOs\PagoDTO\BuscarPagoPorIdDTO.cs
***********************************
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace CasosDeUso.DTOs.PagoDTO
{
    public class BuscarPagoPorIdDTO
    {
        [DisplayName("Identificador")]
        public int IdPago { get; set; }


        [DisplayName("Método de pago")]
        public string MetodoPago { get; set; }


        [DisplayName("Tipo de pago")]
        public string TipoPago { get; set; }


        [DisplayName("Id de usuario")]
        public int UsuarioId { get; set; }


        [DisplayName("Nombre usuario")]
        public string NombreUsuario { get; set; }


        [DisplayName("Descripción de pago")]
        public string DescripcionPago { get; set; }


        [DisplayName("Monto de pago")]
        public decimal? MontoPago { get; set; }
    }
}

***********************************
Archivo: BuscarPagoUnicoMayorADTO.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\CasosDeUso\DTOs\PagoDTO\BuscarPagoUnicoMayorADTO.cs
***********************************
using System;
using System.Collections.Generic;
using System.ComponentModel.DataAnnotations;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace CasosDeUso.DTOs.PagoDTO
{
    public class BuscarPagoUnicoMayorADTO
    {
        [Required(ErrorMessage = "Debe ingresar un monto")]

        public decimal? Monto { get; set; }
    }
}

***********************************
Archivo: ListadoPagoDTO.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\CasosDeUso\DTOs\PagoDTO\ListadoPagoDTO.cs
***********************************
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace CasosDeUso.DTOs.PagoDTO
{
    public class ListadoPagoDTO
    {
        [DisplayName("Identificador")]
        public int IdPago { get; set; }

        
        [DisplayName("Descripción de Pago")]
        public string DescripcionPago { get; set; }

        
        [DisplayName("Nombre Usuario")]
        public string NombreUsuario { get; set; }

        
        [DisplayName("Rol")]
        public string RolUsuario { get; set; }

        
        [DisplayName("Tipo de pago")]
        public string TipoPago { get; set; }

        
        [DisplayName("Descripción de Tipo de Pago")]
        public string DescTipoPago { get; set; }


        [DisplayName("Método de Pago")]
        public string MetodoPago { get; set; }
        public decimal? Montopago { get; set; }

    }
}

***********************************
Archivo: ListaFiltroPagoXFecha.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\CasosDeUso\DTOs\PagoDTO\ListaFiltroPagoXFecha.cs
***********************************
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace CasosDeUso.DTOs.PagoDTO
{
    public class ListaFiltroPagoXFecha
    {
        [DisplayName("Identificador")]
        public int Id { get; set; }

        
        [DisplayName("Método de Pago")]
        public string NombreMetodoPago { get; set; }


        [DisplayName("Tipo de Pago")]
        public string NombreTipoGasto { get; set; }


        [DisplayName("Descripción")]
        public string NombreGasto { get; set; }

        [DisplayName("Fecha de compra")]
        public DateTime FechaCompra { get; set; }

        [DisplayName("Valor de compra")]
        public decimal ValorCompra { get; set; }

        [DisplayName("Saldo pendiente")]
        public decimal SaldoPendiente { get; set; }
    }
}

***********************************
Archivo: ListaPagoUnicoMayorADTO.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\CasosDeUso\DTOs\PagoDTO\ListaPagoUnicoMayorADTO.cs
***********************************
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace CasosDeUso.DTOs.PagoDTO
{
    public class ListaPagoUnicoMayorADTO
    {
        [DisplayName("Id de Pago")]
        public int IdPgo { get; set; }

        [DisplayName("Descripción de Pago")]
        public string DescripcionPago { get; set; }

        [DisplayName("Usuario")]
        public string NombreUsuario { get; set; }

        [DisplayName("Valor de compra")]
        public decimal? ValorCompra { get; set; }
    }
}

***********************************
Archivo: PagoRecurrenteDTO.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\CasosDeUso\DTOs\PagoRecurrenteDTO\PagoRecurrenteDTO.cs
***********************************
using CasosDeUso.DTOs.MetodoPagoDTO;
using CasosDeUso.DTOs.TipoGastoDTOs;
using CasosDeUso.DTOs.UsuarioDTOs;
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.ComponentModel.DataAnnotations;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace CasosDeUso.DTOs.PagoRecurrenteDTO
{
    public class PagoRecurrenteDTO
    {

        [Required(ErrorMessage = "Ingrese una Descripcion")]
        public string Descripcion { get; set; }


        [DisplayName("Fecha desde")]
        public DateTime FechaDesde { get; set; } = DateTime.Today;


        [DisplayName("Fecha hasta")]
        public DateTime FechaHasta { get; set; } = DateTime.Today;


        [DisplayName("Valor de compra")]
        public decimal ValorCompra { get; set; }


        [DisplayName("Seleccione un Usuario ")]
        public int UsuarioId { get; set; }


        [DisplayName("Seleccione un Tipo de Gasto ")]
        public int TipoGastoId { get; set; }


        [DisplayName("Seleccione un Método de Gasto ")]
        public int MetodoPagoId { get; set; }


        public IEnumerable<ListadoUsuarioDTO> Usuarios { get; set; } = new List<ListadoUsuarioDTO>();
        public IEnumerable<ListadoTipoGastoDTO> TipoGastos { get; set; } = new List<ListadoTipoGastoDTO>();
        public IEnumerable<ListadoMetodoPagoDTO> MetodoPagos { get; set; } = new List<ListadoMetodoPagoDTO>();
    }
}

***********************************
Archivo: PagoUnicoDTO.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\CasosDeUso\DTOs\PagoUnicoDTO\PagoUnicoDTO.cs
***********************************
using CasosDeUso.DTOs.MetodoPagoDTO;
using CasosDeUso.DTOs.TipoGastoDTOs;
using CasosDeUso.DTOs.UsuarioDTOs;
using LogicaNegocio.EntidadesNegocio;
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.ComponentModel.DataAnnotations;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace CasosDeUso.DTOs.PagoUnicoDTO
{
    public class PagoUnicoDTO
    {
        [Required(ErrorMessage = "La Descripcion es obligatoria")]
        public string Descripcion { get; set; }


        [Required(ErrorMessage = "Debe ingresar un número de recibo")]
        [DisplayName("Número de recibo")]
        public int NumeroRecibo { get; set; }


        [DisplayName("Fecha de pago")]
        [Required(ErrorMessage = "La fecha de pago es obligatoria")]
        public DateTime FechaPago { get; set; } = DateTime.Today;


        [DisplayName("Ingrese un Monto de pago")]
        //[Required(ErrorMessage = "Debe ingresar un monto de pago")]
        public decimal MontoPago { get; set; }

        [DisplayName("Seleccione un Usuario: ")]
        public int UsuarioId { get; set; }
        [DisplayName("Seleccione un Tipo de gasto: ")]
        public int TipoGastoId { get; set; }
        [DisplayName("Método de pago: ")]
        public int MetodoPagoId { get; set; }
        public IEnumerable<ListadoUsuarioDTO> Usuarios { get; set; } = new List<ListadoUsuarioDTO>();
        public IEnumerable<ListadoTipoGastoDTO> TipoGastos { get; set; } = new List<ListadoTipoGastoDTO>();
        public IEnumerable<ListadoMetodoPagoDTO> MetodoPagos { get; set; } = new List<ListadoMetodoPagoDTO>();

    }
}

***********************************
Archivo: AltaRolDTO.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\CasosDeUso\DTOs\RolDTO\AltaRolDTO.cs
***********************************
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace CasosDeUso.DTOs.RolDTO
{
    public class AltaRolDTO
    {
        public int Id{ get; set; }
        public string NombreRol { get; set; }
    }
}

***********************************
Archivo: ListadoRolParaLoginDTO.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\CasosDeUso\DTOs\RolDTO\ListadoRolParaLoginDTO.cs
***********************************
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace CasosDeUso.DTOs.RolDTO
{
    public class ListadoRolParaLoginDTO
    {
        public int Id { get; set; }
        public string Nombre { get; set; }
    }
}

***********************************
Archivo: ListarRolParaAltaUsuarioDTO.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\CasosDeUso\DTOs\RolDTO\ListarRolParaAltaUsuarioDTO.cs
***********************************
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace CasosDeUso.DTOs.RolDTO
{
    public class ListarRolParaAltaUsuarioDTO
    {
        public int Id { get; set; }
        public string Nombre { get; set; }
    }
}

***********************************
Archivo: DetalleTipoGastoDTO.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\CasosDeUso\DTOs\TipoGastoDTOs\DetalleTipoGastoDTO.cs
***********************************
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace CasosDeUso.DTOs.TipoGastoDTOs
{
    public class DetalleTipoGastoDTO
    {
        [DisplayName("Identificador")]
        public int Id { get; set; } 
        public string Nombre { get; set; }
        public string Descripcion { get; set; }
    }
}

***********************************
Archivo: ListadoTipoGastoDTO.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\CasosDeUso\DTOs\TipoGastoDTOs\ListadoTipoGastoDTO.cs
***********************************
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace CasosDeUso.DTOs.TipoGastoDTOs
{
    public class ListadoTipoGastoDTO
    {

        [DisplayName("Identificador")]
        public int Id { get; set; }
        public string Nombre { get; set; }
        public string Descripcion { get; set; }
    }
}

***********************************
Archivo: TipoGastoDTO.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\CasosDeUso\DTOs\TipoGastoDTOs\TipoGastoDTO.cs
***********************************
using System;
using System.Collections.Generic;
using System.ComponentModel.DataAnnotations;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace CasosDeUso.DTOs.TipoGastoDTOs
{
    public class TipoGastoDTO
    {
        
        [Required(ErrorMessage ="El Nombre es obligatorio")]
        public string Nombre { get; set; }
        [Required(ErrorMessage = "La Descripcion es obligatoria")]
        public string Descripcion { get; set; }
    }
}

***********************************
Archivo: AltaUsuarioDTO.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\CasosDeUso\DTOs\UsuarioDTOs\AltaUsuarioDTO.cs
***********************************
using CasosDeUso.DTOs.EquipoDTO;
using CasosDeUso.DTOs.MetodoPagoDTO;
using CasosDeUso.DTOs.RolDTO;
using LogicaNegocio.EntidadesNegocio;
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.ComponentModel.DataAnnotations;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace CasosDeUso.DTOs.UsuarioDTOs
{
    public class AltaUsuarioDTO
    {
        //public int Id { get; private set; }

        [Required(ErrorMessage = "El Nombre es obligatorio")]
        public string Nombre { get; set; }

        [Required(ErrorMessage = "El Apellido es obligatorio")]
        public string Apellido { get; set; }

        [Required(ErrorMessage = "La contraseña es obligatoria")]
        [StringLength(100, MinimumLength = 8, ErrorMessage = "La contraseña debe tener como minimo 8 carateres")]
        public string Pass { get; set; }

        [DisplayName("Rol")]
        [Required(ErrorMessage = "Debe seleccionar un rol")]
        public int RolId { get; set; }


        [DisplayName("Equipo")]
        [Required(ErrorMessage = "Debe seleccionar un Equipo")]
        public int EquipoId { get; set; }


        public IEnumerable<ListarRolParaAltaUsuarioDTO> RolesDisponibles  = new List<ListarRolParaAltaUsuarioDTO>();
        public IEnumerable<EquipoDTOs> Equipos { get; set; } = new List<EquipoDTOs>();
        
    }
}

***********************************
Archivo: DetalleLoginUsuarioDTO.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\CasosDeUso\DTOs\UsuarioDTOs\DetalleLoginUsuarioDTO.cs
***********************************
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace CasosDeUso.DTOs.UsuarioDTOs
{
    public class DetalleLoginUsuarioDTO
    {
        public int Id { get; set; }
        public string Nombre { get; set; }
        public string Mail { get; set; }
        public string Password { get; set; }
        public string Rol { get; set; }
    }
}

***********************************
Archivo: ListadoUsuarioDTO.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\CasosDeUso\DTOs\UsuarioDTOs\ListadoUsuarioDTO.cs
***********************************
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace CasosDeUso.DTOs.UsuarioDTOs
{
    public class ListadoUsuarioDTO
    {
        [DisplayName("Identificador")]
        public int Id { get; set; }
        public string Nombre { get; set; }
        public string Mail { get; set; }
    }
}

***********************************
Archivo: UsuarioLoginDTO.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\CasosDeUso\DTOs\UsuarioDTOs\UsuarioLoginDTO.cs
***********************************
using System;
using System.Collections.Generic;
using System.ComponentModel.DataAnnotations;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace CasosDeUso.DTOs.UsuarioDTOs
{
    public class UsuarioLoginDTO
    {
        [Required(ErrorMessage = "Debe ingresar un mail")]
        public string Mail { get; set; }
        [Required(ErrorMessage = "Debe ingresar un password")]
        public string Password { get; set; }

        
    }
}

***********************************
Archivo: UsusarioLogueadoDTO.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\CasosDeUso\DTOs\UsuarioDTOs\UsusarioLogueadoDTO.cs
***********************************
using CasosDeUso.DTOs.RolDTO;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace CasosDeUso.DTOs.UsuarioDTOs
{
    public class UsusarioLogueadoDTO
    {
        public int Id { get; set; }
        public string Mail { get; set; }
        public string Pass { get; set; }
        public int RolId { get; set; }
        
        public IEnumerable<ListadoRolParaLoginDTO> Roles { get; set; } = new List<ListadoRolParaLoginDTO>();
    }
}

***********************************
Archivo: ICUAltaAuditoria.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\CasosDeUso\InterfacesCU\ICUAuditoria\ICUAltaAuditoria.cs
***********************************
using CasosDeUso.DTOs.AuditoriaDTO;
using LogicaNegocio.EntidadesNegocio;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace CasosDeUso.InterfacesCU.ICUAuditoria
{
    public interface ICUAltaAuditoria
    {
        void Ejecutar(AuditoriaDTO auditoriaDTO);
    }
}

***********************************
Archivo: ICUAltaEquipo.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\CasosDeUso\InterfacesCU\ICUEquipo\ICUAltaEquipo.cs
***********************************
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace CasosDeUso.InterfacesCU.ICUEquipo
{
    public interface ICUAltaEquipo
    {
        void Ejecutar(string nombre);
    }
}

***********************************
Archivo: ICUListarEquipo.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\CasosDeUso\InterfacesCU\ICUEquipo\ICUListarEquipo.cs
***********************************
using CasosDeUso.DTOs.EquipoDTO;
using LogicaNegocio.EntidadesNegocio;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace CasosDeUso.InterfacesCU.ICUEquipo
{
    public interface ICUListarEquipo
    {
        public IEnumerable<EquipoDTOs> Ejecutar();
    }
}

***********************************
Archivo: ICUAltaMetodoPago.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\CasosDeUso\InterfacesCU\ICUMetodoPago\ICUAltaMetodoPago.cs
***********************************
using CasosDeUso.DTOs.MetodoPagoDTO;
using CasosDeUso.DTOs.PagoUnicoDTO;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace CasosDeUso.InterfacesCU.ICUMetodoPago
{
    public interface ICUAltaMetodoPago
    {
        void Ejecutar(MetodoPagoDTO metodoPagoDTO);
    }
}

***********************************
Archivo: ICUBucarMetodoPago.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\CasosDeUso\InterfacesCU\ICUMetodoPago\ICUBucarMetodoPago.cs
***********************************
using CasosDeUso.DTOs.MetodoPagoDTO;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace CasosDeUso.InterfacesCU.ICUMetodoPago
{
    public interface ICUBucarMetodoPago
    {
        DetalleMetodoPagoDTO Ejecutar(int id);
    }
}

***********************************
Archivo: ICUListadoMetodoPago.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\CasosDeUso\InterfacesCU\ICUMetodoPago\ICUListadoMetodoPago.cs
***********************************
using CasosDeUso.DTOs.MetodoPagoDTO;
using CasosDeUso.DTOs.TipoGastoDTOs;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace CasosDeUso.InterfacesCU.ICUListadoMetodoPago
{
    public interface ICUListadoMetodoPago
    {
        public IEnumerable<ListadoMetodoPagoDTO> Ejecutar();
    }
}

***********************************
Archivo: ICUAltaPagoRecurrente.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\CasosDeUso\InterfacesCU\ICUPago\ICUAltaPagoRecurrente.cs
***********************************
using CasosDeUso.DTOs.PagoRecurrenteDTO;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace CasosDeUso.InterfacesCU.ICUPago
{
    public interface ICUAltaPagoRecurrente
    {
        void Ejecutar(PagoRecurrenteDTO pagoRecurrente);
    }
}

***********************************
Archivo: ICUAltaPagoUnico.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\CasosDeUso\InterfacesCU\ICUPago\ICUAltaPagoUnico.cs
***********************************
using CasosDeUso.DTOs.PagoUnicoDTO;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace CasosDeUso.InterfacesCU.ICUPago
{
    public interface ICUAltaPagoUnico
    {
        void Ejecutar(PagoUnicoDTO pagoUnicoDTO);
    }
}

***********************************
Archivo: ICUBuscarPagoPorId.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\CasosDeUso\InterfacesCU\ICUPago\ICUBuscarPagoPorId.cs
***********************************
using CasosDeUso.DTOs.PagoDTO;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace CasosDeUso.InterfacesCU.ICUPago
{
    public interface ICUBuscarPagoPorId
    {
        BuscarPagoPorIdDTO Ejecutar(int id);
    }
}

***********************************
Archivo: ICUBuscarPagoPorValorMayorA.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\CasosDeUso\InterfacesCU\ICUPago\ICUBuscarPagoPorValorMayorA.cs
***********************************
using CasosDeUso.DTOs.PagoDTO;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace CasosDeUso.InterfacesCU.ICUPago
{
    public interface ICUBuscarPagoPorValorMayorA
    {
        IEnumerable<ListaPagoUnicoMayorADTO> Ejecutar(decimal? monto);
    }
}

***********************************
Archivo: ICUFiltrarPagosXFecha.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\CasosDeUso\InterfacesCU\ICUPago\ICUFiltrarPagosXFecha.cs
***********************************
using CasosDeUso.DTOs.PagoDTO;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace CasosDeUso.InterfacesCU.ICUPago
{
    public interface ICUFiltrarPagosXFecha
    {
        IEnumerable<ListaFiltroPagoXFecha> Ejecutar(DateTime fecha);
    }
}

***********************************
Archivo: ICUListadoPago.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\CasosDeUso\InterfacesCU\ICUPago\ICUListadoPago.cs
***********************************
using CasosDeUso.DTOs.PagoDTO;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace CasosDeUso.InterfacesCU.ICUPago
{
    public interface ICUListadoPago
    {
        public IEnumerable<ListadoPagoDTO> Ejecutar();
    }
}

***********************************
Archivo: ICUAltaRol.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\CasosDeUso\InterfacesCU\ICURol\ICUAltaRol.cs
***********************************
using CasosDeUso.DTOs.RolDTO;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace CasosDeUso.InterfacesCU.ICURol
{
    public interface ICUAltaRol
    {
        void Ejecutar(AltaRolDTO rolDTO);
    }
}

***********************************
Archivo: ICUListadoRolParaLogin.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\CasosDeUso\InterfacesCU\ICURol\ICUListadoRolParaLogin.cs
***********************************
using CasosDeUso.DTOs.RolDTO;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace CasosDeUso.InterfacesCU.ICURol
{
    public interface ICUListadoRolParaLogin
    {
        IEnumerable<ListadoRolParaLoginDTO> Ejecutar();
    }
}

***********************************
Archivo: ICUListarRol.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\CasosDeUso\InterfacesCU\ICURol\ICUListarRol.cs
***********************************
using CasosDeUso.DTOs.RolDTO;
using LogicaNegocio.InterfacesRepositorio;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace CasosDeUso.InterfacesCU.ICURol
{
    public interface ICUListarRol
    {
        public IEnumerable<ListarRolParaAltaUsuarioDTO> Ejecutar();
    }
}

***********************************
Archivo: ICUAltaTipoGasto.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\CasosDeUso\InterfacesCU\ICUTipoGasto\ICUAltaTipoGasto.cs
***********************************
using CasosDeUso.DTOs.TipoGastoDTOs;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace CasosDeUso.InterfacesCU.CUTipoGasto
{
    public interface ICUAltaTipoGasto
    {
        void Ejecutar(TipoGastoDTO tipoGastoDTO);
    }
}

***********************************
Archivo: ICUBuscarTipoGasto.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\CasosDeUso\InterfacesCU\ICUTipoGasto\ICUBuscarTipoGasto.cs
***********************************
using CasosDeUso.DTOs.TipoGastoDTOs;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace CasosDeUso.InterfacesCU.ICUTipoGasto
{
    public interface ICUBuscarTipoGasto
    {
        DetalleTipoGastoDTO Ejecutar(int id);
    }
}

***********************************
Archivo: ICUEditarTipoGasto.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\CasosDeUso\InterfacesCU\ICUTipoGasto\ICUEditarTipoGasto.cs
***********************************
using CasosDeUso.DTOs.TipoGastoDTOs;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace CasosDeUso.InterfacesCU.ICUTipoGasto
{
    public interface ICUEditarTipoGasto
    {
        void Ejecutar(DetalleTipoGastoDTO detalle, int id);
    }
}

***********************************
Archivo: ICUEliminarTipoGasto.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\CasosDeUso\InterfacesCU\ICUTipoGasto\ICUEliminarTipoGasto.cs
***********************************
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace CasosDeUso.InterfacesCU.ICUTipoGasto
{
    public interface ICUEliminarTipoGasto
    {
        void Ejecutar(int id);
    }
}

***********************************
Archivo: ICUListadoTipoGasto.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\CasosDeUso\InterfacesCU\ICUTipoGasto\ICUListadoTipoGasto.cs
***********************************
using CasosDeUso.DTOs.TipoGastoDTOs;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace CasosDeUso.InterfacesCU.ICUTipoGasto
{
    public interface ICUListadoTipoGasto
    {
        public IEnumerable<ListadoTipoGastoDTO> Ejecutar();
    }
}

***********************************
Archivo: ICUAltaUsuario.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\CasosDeUso\InterfacesCU\ICUUsuario\ICUAltaUsuario.cs
***********************************
using CasosDeUso.DTOs.UsuarioDTOs;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace CasosDeUso.InterfacesCU.ICUUsuario
{
    public interface ICUAltaUsuario
    {
        void Ejecutar(AltaUsuarioDTO usuarioDTO);
    }
}

***********************************
Archivo: ICUBuscarUsuario.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\CasosDeUso\InterfacesCU\ICUUsuario\ICUBuscarUsuario.cs
***********************************
using CasosDeUso.DTOs.UsuarioDTOs;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace CasosDeUso.InterfacesCU.ICUUsuario
{
    public interface ICUBuscarUsuario
    {
        DetalleLoginUsuarioDTO Ejecutar(UsuarioLoginDTO usuarioLoginDTO);
    }
}

***********************************
Archivo: ICUListadoUsuarios.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\CasosDeUso\InterfacesCU\ICUUsuario\ICUListadoUsuarios.cs
***********************************
using CasosDeUso.DTOs.UsuarioDTOs;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace CasosDeUso.InterfacesCU.ICUUsuario
{
    public interface ICUListadoUsuarios
    {
        IEnumerable<ListadoUsuarioDTO> Ejecutar();
    }
}

***********************************
Archivo: CUAltaAuditoria.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\LogicaAplicacion\CasosUso\CUAuditoria\CUAltaAuditoria.cs
***********************************
using CasosDeUso.DTOs.AuditoriaDTO;
using CasosDeUso.InterfacesCU.ICUAuditoria;
using ExcepcionesPropias.ExcepcionesEntidades;
using LogicaAplicacion.Mappers;
using LogicaNegocio.EntidadesNegocio;
using LogicaNegocio.InterfacesRepositorio;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace LogicaAplicacion.CasosUso.CUAuditoria
{
    public class CUAltaAuditoria:ICUAltaAuditoria
    {
        public IRepositorioAuditoria RepoAuditoria { get; set; }
        
        
        public CUAltaAuditoria(IRepositorioAuditoria repoAuditoria)
        {
            RepoAuditoria = repoAuditoria;
            
        }

        public void Ejecutar(AuditoriaDTO auditoriaDTO)
        {
            Auditoria auditoria = MapperAuditoria.AuditoriaDTOToAuditoria(auditoriaDTO);
            RepoAuditoria.Add(auditoria);
        }
    }
}

***********************************
Archivo: CUAltaEquipo.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\LogicaAplicacion\CasosUso\CUEquipo\CUAltaEquipo.cs
***********************************
using CasosDeUso.InterfacesCU.ICUEquipo;
using LogicaNegocio.EntidadesNegocio;
using LogicaNegocio.InterfacesRepositorio;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace LogicaAplicacion.CasosUso.CUEquipo
{
    public class CUAltaEquipo : ICUAltaEquipo
    {
        public IRepositorioEquipo RepoEquipo { get; set; }
        public CUAltaEquipo(IRepositorioEquipo repoEquipo)
        {
            RepoEquipo = repoEquipo;
        }

        public void Ejecutar(string nombre)
        {
            if (nombre == null) 
            {
                throw new ArgumentNullException("El nombre esta vacio");
            }
            Equipo equipo = new Equipo(nombre);
            RepoEquipo.Add(equipo);
        }
    }
}

***********************************
Archivo: CUListarEquipo.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\LogicaAplicacion\CasosUso\CUEquipo\CUListarEquipo.cs
***********************************
using CasosDeUso.DTOs.EquipoDTO;
using CasosDeUso.InterfacesCU.ICUEquipo;
using LogicaAplicacion.Mappers;
using LogicaNegocio.EntidadesNegocio;
using LogicaNegocio.InterfacesRepositorio;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace LogicaAplicacion.CasosUso.CUEquipo
{
    public class CUListarEquipo : ICUListarEquipo
    {
        public IRepositorioEquipo RepoEquipo { get; set; }
        public CUListarEquipo(IRepositorioEquipo repo)
        {
            RepoEquipo = repo;
        }
        public IEnumerable<EquipoDTOs> Ejecutar()
        {
            IEnumerable<Equipo> equipos = RepoEquipo.FindAll();
            return MapperEquipo.ListEquipoToListEquipoDTO(equipos);
        }
    }
}

***********************************
Archivo: CUAltaMetodoPago.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\LogicaAplicacion\CasosUso\CUMetodoPago\CUAltaMetodoPago.cs
***********************************
using CasosDeUso.DTOs.MetodoPagoDTO;
using CasosDeUso.DTOs.UsuarioDTOs;
using CasosDeUso.InterfacesCU.ICUMetodoPago;
using LogicaAplicacion.Mappers;
using LogicaNegocio.EntidadesNegocio;
using LogicaNegocio.InterfacesRepositorio;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace LogicaAplicacion.CasosUso.CUMetodoPago
{
    public class CUAltaMetodoPago:ICUAltaMetodoPago
    {
        public IRepositorioMetodoPago RepoMetodoPago { get; set; }

        public CUAltaMetodoPago(IRepositorioMetodoPago repositorioMetodoPago)
        {
            RepoMetodoPago = repositorioMetodoPago;
        }

        public void Ejecutar(MetodoPagoDTO metodoPagoDTO)
        {
            MetodoPago metodoPago = MapperMetodoPago.MetodoPagoDTOToMetodoPago(metodoPagoDTO);
            RepoMetodoPago.Add(metodoPago);
        }
    }
}

***********************************
Archivo: CUBucarMetodoPago.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\LogicaAplicacion\CasosUso\CUMetodoPago\CUBucarMetodoPago.cs
***********************************
using CasosDeUso.DTOs.MetodoPagoDTO;
using CasosDeUso.InterfacesCU.ICUMetodoPago;
using ExcepcionesPropias.ExcepcionesEntidades;
using LogicaAplicacion.Mappers;
using LogicaNegocio.EntidadesNegocio;
using LogicaNegocio.InterfacesRepositorio;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace LogicaAplicacion.CasosUso.CUMetodoPago
{
    public class CUBucarMetodoPago : ICUBucarMetodoPago
    {
        public IRepositorioMetodoPago RepoMetodoPago { get; set; }
        public CUBucarMetodoPago(IRepositorioMetodoPago repoMetodoPago)
        {
            RepoMetodoPago = repoMetodoPago;
        }


        public DetalleMetodoPagoDTO Ejecutar(int id)
        {
            MetodoPago metodoPago = RepoMetodoPago.FindById(id);
            if (metodoPago != null)
            {
                return MapperMetodoPago.MetodoPagoToMetodoPagoDTO(metodoPago);
            }
            else
            {
                throw new MetodoPagoException("No se encontro el metodo de pago");
            }

        }
    }
}

***********************************
Archivo: CUListadoMetodoPago.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\LogicaAplicacion\CasosUso\CUMetodoPago\CUListadoMetodoPago.cs
***********************************
using CasosDeUso.DTOs.MetodoPagoDTO;
using CasosDeUso.InterfacesCU.ICUListadoMetodoPago;
using LogicaAccesoDatos.Repositorios;
using LogicaAplicacion.Mappers;
using LogicaNegocio.EntidadesNegocio;
using LogicaNegocio.InterfacesRepositorio;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace LogicaAplicacion.CasosUso.CUMetodoPago
{
    public class CUListadoMetodoPago : ICUListadoMetodoPago
    {
        public IRepositorioMetodoPago RepoMetodoPago { get; set; }
        public CUListadoMetodoPago(IRepositorioMetodoPago repoMetodoPago)
        {
            RepoMetodoPago = repoMetodoPago;
        }



        public IEnumerable<ListadoMetodoPagoDTO> Ejecutar()
        {
            IEnumerable<MetodoPago> metodoPagos = RepoMetodoPago.FindAll();
            return MapperMetodoPago.ListMetodoPagoToMetodoPagoDTO(metodoPagos);
        }




    }
}

***********************************
Archivo: CUAltaPagoRecurrente.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\LogicaAplicacion\CasosUso\CUPago\CUAltaPagoRecurrente.cs
***********************************
using CasosDeUso.DTOs.PagoRecurrenteDTO;
using CasosDeUso.DTOs.PagoUnicoDTO;
using CasosDeUso.InterfacesCU.ICUPago;
using ExcepcionesPropias.ExcepcionesEntidades;
using LogicaAplicacion.Mappers;
using LogicaNegocio.EntidadesNegocio;
using LogicaNegocio.InterfacesRepositorio;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace LogicaAplicacion.CasosUso.CUPago
{
    public class CUAltaPagoRecurrente : ICUAltaPagoRecurrente
    {
        public IRepositorioPago RepoPago { get; set; }
        public IRepositorioMetodoPago RepoMetodoPago { get; set; }
        public IRepositorioUsuario RepoUsuario { get; set; }
        public IRepositorioTipoGastos RepoTipoGasto { get; set; }

        public CUAltaPagoRecurrente(IRepositorioPago repoPago, IRepositorioMetodoPago repoMetodoPago, IRepositorioUsuario repoUsuario, IRepositorioTipoGastos repoTipoGasto)
        {
            RepoPago = repoPago;
            RepoMetodoPago = repoMetodoPago;
            RepoUsuario = repoUsuario;
            RepoTipoGasto = repoTipoGasto;
        }

        public void Ejecutar(PagoRecurrenteDTO pagoRecurrenteDTO)
        {
            Usuario usuario = RepoUsuario.FindById(pagoRecurrenteDTO.UsuarioId);
            TipoGasto tipoGasto = RepoTipoGasto.FindById(pagoRecurrenteDTO.TipoGastoId);
            MetodoPago metodoPago = RepoMetodoPago.FindById(1);

            if (pagoRecurrenteDTO != null)
            {
                if (usuario is null)
                {
                    throw new PagoException("Ususario no encontrado");
                }
                if (tipoGasto is null)
                {
                    throw new PagoException("Tipo de gasto no encontrado");
                }
                if (metodoPago is null)
                {
                    throw new PagoException("Metodo de pago no encontrado");
                }
                if (pagoRecurrenteDTO.ValorCompra <= 0)
                {
                    throw new PagoException("El valor de compra debe ser un monto mayor a cero");
                }
            }
            else
            {
                throw new ArgumentNullException("Datos incorrectos");
            }
            PagoRecurrente recurrente = MapperPago.PagoRecurrenteDTOToPagoRecuerrente(pagoRecurrenteDTO, usuario, tipoGasto, metodoPago);
            RepoPago.Add(recurrente);
        }
    }
}

***********************************
Archivo: CUAltaPagoUnico.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\LogicaAplicacion\CasosUso\CUPago\CUAltaPagoUnico.cs
***********************************
using CasosDeUso.DTOs.PagoUnicoDTO;
using CasosDeUso.InterfacesCU.ICUPago;
using ExcepcionesPropias.ExcepcionesEntidades;
using LogicaAplicacion.Mappers;
using LogicaNegocio.EntidadesNegocio;
using LogicaNegocio.InterfacesRepositorio;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace LogicaAplicacion.CasosUso.CUPago
{
    public class CUAltaPagoUnico : ICUAltaPagoUnico
    {
        public IRepositorioPago RepoPago { get; set; }
        public IRepositorioUsuario RepoUsuario { get; set; }
        public IRepositorioTipoGastos RepoTipoGasto { get; set; }
        public IRepositorioMetodoPago RepoMetodoPago { get; set; }
        public CUAltaPagoUnico(IRepositorioPago repoPago, IRepositorioUsuario repositorioUsuario, IRepositorioTipoGastos tipoGastos, IRepositorioMetodoPago metodoPago)
        {
            RepoPago = repoPago;
            RepoUsuario = repositorioUsuario;
            RepoTipoGasto = tipoGastos;
            RepoMetodoPago = metodoPago;
        }

        public void Ejecutar(PagoUnicoDTO pagoUnicoDTO)
        {
            //Me queda la duda si hacer el metodoPago como valueObject
            Usuario usuario = RepoUsuario.FindById(pagoUnicoDTO.UsuarioId);
            TipoGasto tipoGasto = RepoTipoGasto.FindById(pagoUnicoDTO.TipoGastoId);
            MetodoPago metodoPago = RepoMetodoPago.FindById(2);
            string descripcion = pagoUnicoDTO.Descripcion;

            if (usuario is null)
            {
                throw new ArgumentNullException("Ususario no encontrado");
            }
            if (tipoGasto is null)
            {
                throw new ArgumentNullException("Tipo de gasto no encontrado");
            }
            if (metodoPago is null)
            {
                throw new ArgumentNullException("Metodo de pago no encontrado");
            }
            if (string.IsNullOrEmpty(descripcion))
            {
                throw new PagoException("Descripcion no encontrada");
            }
            if (pagoUnicoDTO.Descripcion is null)
            {
                throw new ArgumentNullException("La descripción no puede ser nula");
            }
            if (pagoUnicoDTO.NumeroRecibo <= 0)
            {
                throw new PagoException("El número de recibo no puede ser cero o un número negativo");
            }
            if (pagoUnicoDTO.MontoPago <= 0)
            {
                throw new PagoException("El monto de pago no puede ser cero");
            }
            var min = new DateTime(2023, 1, 1);   // 01/01/2023
            if (pagoUnicoDTO.FechaPago.Date <= min)
            {
                throw new PagoException("La fecha debe ser posterior a 01/01/2023");
            }
            PagoUnico pagoUnico = MapperPago.PagoUnicoDTOToPagoUnico(pagoUnicoDTO, usuario, tipoGasto, metodoPago);
            RepoPago.Add(pagoUnico);
        }
    }
}

***********************************
Archivo: CUBuscarPagoPorId.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\LogicaAplicacion\CasosUso\CUPago\CUBuscarPagoPorId.cs
***********************************
using CasosDeUso.DTOs.PagoDTO;
using CasosDeUso.InterfacesCU.ICUPago;
using ExcepcionesPropias.ExcepcionesEntidades;
using LogicaAplicacion.Mappers;
using LogicaNegocio.EntidadesNegocio;
using LogicaNegocio.InterfacesRepositorio;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace LogicaAplicacion.CasosUso.CUPago
{
    public class CUBuscarPagoPorId : ICUBuscarPagoPorId
    {
        public IRepositorioPago RepoPago { get; set; }
        public CUBuscarPagoPorId(IRepositorioPago repoPago)
        {
            RepoPago = repoPago;
        }


        public BuscarPagoPorIdDTO Ejecutar(int id)
        {
            Pago pagos = RepoPago.FindById(id);
            if( pagos == null)
            {
                throw new PagoException("No existe el Pago con ese Id");
            }
            return MapperPago.BuscarPagoPorIdToBuscarPagoPorIdDTO( pagos );
        }
    }
}

***********************************
Archivo: CUBuscarPagoPorValorMayorA.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\LogicaAplicacion\CasosUso\CUPago\CUBuscarPagoPorValorMayorA.cs
***********************************
using CasosDeUso.DTOs.PagoDTO;
using CasosDeUso.InterfacesCU.ICUPago;
using ExcepcionesPropias.ExcepcionesEntidades;
using LogicaAplicacion.Mappers;
using LogicaNegocio.EntidadesNegocio;
using LogicaNegocio.InterfacesRepositorio;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace LogicaAplicacion.CasosUso.CUPago
{
    public class CUBuscarPagoPorValorMayorA : ICUBuscarPagoPorValorMayorA
    {
        public IRepositorioPago RepoPago { get; set; }
        public CUBuscarPagoPorValorMayorA(IRepositorioPago repo)
        {
            RepoPago = repo;
        }
        public IEnumerable<ListaPagoUnicoMayorADTO> Ejecutar(decimal? monto)
        {
            IEnumerable<PagoUnico> pagoUnicos = RepoPago.BuscarPagoUnicoPorMontoMayorA(monto);
            if(pagoUnicos is null || pagoUnicos.Count() == 0)
            {
                throw new PagoException("No existen pagos únicos mayor a: "+ monto);
            }
            return MapperPago.PagoUnicoToPagoUnicoDTO (pagoUnicos);
        }
    }
}

***********************************
Archivo: CUFiltarPagosPorFecha.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\LogicaAplicacion\CasosUso\CUPago\CUFiltarPagosPorFecha.cs
***********************************
using CasosDeUso.DTOs.PagoDTO;
using CasosDeUso.InterfacesCU.ICUPago;
using ExcepcionesPropias.ExcepcionesEntidades;
using LogicaAplicacion.Mappers;
using LogicaNegocio.EntidadesNegocio;
using LogicaNegocio.InterfacesRepositorio;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace LogicaAplicacion.CasosUso.CUPago
{
    public class CUFiltarPagosPorFecha : ICUFiltrarPagosXFecha
    {
        public IRepositorioPago RepoPago { get; set; }
        public CUFiltarPagosPorFecha(IRepositorioPago repositorioPago)
        {
            RepoPago = repositorioPago;
        }

        public IEnumerable<ListaFiltroPagoXFecha> Ejecutar(DateTime fecha)
        {
            IEnumerable<Pago> pagos = RepoPago.BuscarPagosMixtosPorFecha(fecha);

            if (pagos == null || pagos.Count() == 0)
            {
                throw new PagoException("No se encontraron pagos únicos con esa fecha");
            }
            return MapperPago.PagoUnicoFiltradoToPagoUnicoFiltradoDTO (pagos);
        }
    }
}

***********************************
Archivo: CUListadoPago.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\LogicaAplicacion\CasosUso\CUPago\CUListadoPago.cs
***********************************
using CasosDeUso.DTOs.PagoDTO;
using CasosDeUso.InterfacesCU.ICUPago;
using LogicaAplicacion.Mappers;
using LogicaNegocio.EntidadesNegocio;
using LogicaNegocio.InterfacesRepositorio;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace LogicaAplicacion.CasosUso.CUPago
{
    public class CUListadoPago:ICUListadoPago
    {
        public IRepositorioPago RepoPago { get; set; }
        public CUListadoPago(IRepositorioPago repoPago)
        {
            RepoPago = repoPago;
        }

        IEnumerable<ListadoPagoDTO> ICUListadoPago.Ejecutar()
        {
            IEnumerable<Pago> pagos = RepoPago.FindAll();
            return MapperPago.ListadoPagoToListadoPagoDTO(pagos);
        }
    }
}

***********************************
Archivo: CUAltaRol.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\LogicaAplicacion\CasosUso\CURol\CUAltaRol.cs
***********************************
using CasosDeUso.DTOs.RolDTO;
using CasosDeUso.InterfacesCU.ICURol;
using LogicaAplicacion.Mappers;
using LogicaNegocio.EntidadesNegocio;
using LogicaNegocio.InterfacesRepositorio;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace LogicaAplicacion.CasosUso.CURol
{
    public class CUAltaRol : ICUAltaRol
    {
        public IRepositorioRol RepoRol { get; set; }
        public CUAltaRol(IRepositorioRol repoRol)
        {
            RepoRol = repoRol;
        }


        public void Ejecutar(AltaRolDTO rolDTO)
        {
            if (rolDTO == null)
            {
                throw new ArgumentNullException("Datos incorrectos");
            }
            Rol rol = MapperRol.RolDTOToRol(rolDTO);
            RepoRol.Add(rol);
        }
    }
}

***********************************
Archivo: CUListadoRolParaLogin.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\LogicaAplicacion\CasosUso\CURol\CUListadoRolParaLogin.cs
***********************************
using CasosDeUso.DTOs.RolDTO;
using CasosDeUso.InterfacesCU.ICURol;
using LogicaAplicacion.Mappers;
using LogicaNegocio.EntidadesNegocio;
using LogicaNegocio.InterfacesRepositorio;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace LogicaAplicacion.CasosUso.CURol
{
    public class CUListadoRolParaLogin : ICUListadoRolParaLogin
    {
        public IRepositorioRol RepoRol {  get; set; }

        public CUListadoRolParaLogin(IRepositorioRol reporol)
        {
            RepoRol = reporol;
        }
        public IEnumerable<ListadoRolParaLoginDTO> Ejecutar()
        {
            IEnumerable<Rol> rol = RepoRol.FindAll();
            return MapperRol.ListadoRolLoginToListadoRolLoginDTO(rol);
        }
    }
}

***********************************
Archivo: CUListarRolParaAltaUsuario.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\LogicaAplicacion\CasosUso\CURol\CUListarRolParaAltaUsuario.cs
***********************************
using CasosDeUso.DTOs.RolDTO;
using CasosDeUso.InterfacesCU.ICURol;
using LogicaAplicacion.Mappers;
using LogicaNegocio.EntidadesNegocio;
using LogicaNegocio.InterfacesRepositorio;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace LogicaAplicacion.CasosUso.CURol
{
    public class CUListarRolParaAltaUsuario : ICUListarRol
    {

        public IRepositorioRol RepoRol { get; set; }
        public CUListarRolParaAltaUsuario(IRepositorioRol repoRol)
        {
            RepoRol = repoRol;
        }

        public IEnumerable<ListarRolParaAltaUsuarioDTO> Ejecutar()
        {
            IEnumerable<Rol> rol = RepoRol.FindAll();
            return MapperRol.ListadoRolToListadoRolDTO (rol);
        }
    }
}

***********************************
Archivo: CUAltaTipoGasto.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\LogicaAplicacion\CasosUso\CUTipoGasto\CUAltaTipoGasto.cs
***********************************
using CasosDeUso.DTOs.TipoGastoDTOs;
using CasosDeUso.InterfacesCU.CUTipoGasto;
using LogicaAplicacion.Mappers;
using LogicaNegocio.EntidadesNegocio;
using LogicaNegocio.InterfacesRepositorio;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace LogicaAplicacion.CasosUso.CUTipoGasto
{
    public class CUAltaTipoGasto : ICUAltaTipoGasto
    {
        public IRepositorioTipoGastos RepoTipoGastos { get; set; }

        public CUAltaTipoGasto(IRepositorioTipoGastos repositorioTipoGastos)
        {
            RepoTipoGastos = repositorioTipoGastos;
        }

        public void Ejecutar(TipoGastoDTO tipoGastoDTO)
        {
            TipoGasto tipoGasto = MapperTipoGasto.TipoGastoDTOToTipoGasto(tipoGastoDTO);
            RepoTipoGastos.Add(tipoGasto);
        }
    }
}

***********************************
Archivo: CUBuscarTipoGasto.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\LogicaAplicacion\CasosUso\CUTipoGasto\CUBuscarTipoGasto.cs
***********************************
using CasosDeUso.DTOs.TipoGastoDTOs;
using CasosDeUso.InterfacesCU.ICUTipoGasto;
using ExcepcionesPropias.ExcepcionesEntidades;
using LogicaNegocio.EntidadesNegocio;
using LogicaNegocio.InterfacesRepositorio;
using LogicaAplicacion.Mappers;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace LogicaAplicacion.CasosUso.CUTipoGasto
{
    public class CUBuscarTipoGasto:ICUBuscarTipoGasto
    {
        //INYECCION DE DEPENDENCIA
        public IRepositorioTipoGastos RepoTipoGasto { get; set; }

        public CUBuscarTipoGasto(IRepositorioTipoGastos repoTipoGasto)
        {
            RepoTipoGasto = repoTipoGasto;
        }

        //METODO QUE LLAMO DESDE EL CONTROLADOR
        public DetalleTipoGastoDTO Ejecutar(int id)
        {
            TipoGasto tipogasto = RepoTipoGasto.FindById(id);
            if (tipogasto != null)
            {
                return MapperTipoGasto.TipoGastoToDetalleTipoGastoDTO(tipogasto);
            }
            else
            {
                throw new GastoException("No se encontró un Tipo de gasto con ese id");
            }
        }

    }
}

***********************************
Archivo: CUEditarTipoGasto.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\LogicaAplicacion\CasosUso\CUTipoGasto\CUEditarTipoGasto.cs
***********************************
using CasosDeUso.DTOs.TipoGastoDTOs;
using CasosDeUso.InterfacesCU.ICUTipoGasto;
using LogicaNegocio.EntidadesNegocio;
using LogicaNegocio.InterfacesRepositorio;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace LogicaAplicacion.CasosUso.CUTipoGasto
{
    public class CUEditarTipoGasto:ICUEditarTipoGasto
    {
        public IRepositorioTipoGastos RepoTipoGasto { get; set; }
        public CUEditarTipoGasto(IRepositorioTipoGastos repoTipoGasto)
        {
            RepoTipoGasto = repoTipoGasto;
        }

        public void Ejecutar(DetalleTipoGastoDTO detalleTipoGasto, int id)
        {
            if (id <= 0)
            {
                throw new ArgumentException("El id no es correcto");
            }
            if (detalleTipoGasto == null)
            {
                throw new ArgumentNullException("Datos incorrectos");
            }
            TipoGasto tipo = RepoTipoGasto.FindById(id);
            tipo.Nombre = detalleTipoGasto.Nombre;
            tipo.Descripcion = detalleTipoGasto.Descripcion;
            RepoTipoGasto.Update(tipo);

        }
    }
}



***********************************
Archivo: CUEliminarTipoGasto.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\LogicaAplicacion\CasosUso\CUTipoGasto\CUEliminarTipoGasto.cs
***********************************
using CasosDeUso.InterfacesCU.ICUTipoGasto;
using ExcepcionesPropias.ExcepcionesEntidades;
using LogicaNegocio.EntidadesNegocio;
using LogicaNegocio.InterfacesRepositorio;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace LogicaAplicacion.CasosUso.CUTipoGasto
{
    public class CUEliminarTipoGasto:ICUEliminarTipoGasto
    {
        public IRepositorioTipoGastos RepoTipoGasto { get; set; }
        public IRepositorioPago RepoPago { get; set; }

        public CUEliminarTipoGasto(IRepositorioTipoGastos repoTipoGastos, IRepositorioPago repoPago)
        {
            RepoTipoGasto = repoTipoGastos;
            RepoPago = repoPago;
        }

        public void Ejecutar(int id)
        {
            if (id > 0)
            {
                TipoGasto tipoGasto = RepoTipoGasto.FindById(id);

                if (tipoGasto != null)
                {
                    //Verifico que el tipo de gasto no esté en uso, si no está, lo eliminio
                    if(!RepoPago.ExisteTipoGasto(id))
                    {
                        RepoTipoGasto.Delete(tipoGasto);
                    }
                    else
                    {
                        throw new GastoException("No se puede eliminar el Tipo de Gasto porque esta en uso");
                    }
                }
                else
                {
                    throw new GastoException("No existe un tipo de gasto con ese ID");
                }
            }
            else
            {
                throw new ArgumentNullException("El id no es correcto");
            }
        }
    }
}

***********************************
Archivo: CUListadoTipoGasto.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\LogicaAplicacion\CasosUso\CUTipoGasto\CUListadoTipoGasto.cs
***********************************
using CasosDeUso.DTOs.TipoGastoDTOs;
using CasosDeUso.InterfacesCU.ICUTipoGasto;
using LogicaAplicacion.Mappers;
using LogicaNegocio.EntidadesNegocio;
using LogicaNegocio.InterfacesRepositorio;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace LogicaAplicacion.CasosUso.CUTipoGasto
{
    public class CUListadoTipoGasto:ICUListadoTipoGasto
    {
        //Aplico Inyeccion de dependencia
        public IRepositorioTipoGastos RepoTipoGasto { get; set; }

        public CUListadoTipoGasto (IRepositorioTipoGastos repoTipoGasto)
        {
            RepoTipoGasto = repoTipoGasto;
        }

        public IEnumerable<ListadoTipoGastoDTO> Ejecutar()
        {
            IEnumerable<TipoGasto> tipoGastos = RepoTipoGasto.FindAll();
            return MapperTipoGasto.ListTipoGastoToTipoGastoDTO(tipoGastos);
        }
    }
}

***********************************
Archivo: CUAltaUsuario.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\LogicaAplicacion\CasosUso\CUUsuario\CUAltaUsuario.cs
***********************************
using CasosDeUso.DTOs.TipoGastoDTOs;
using CasosDeUso.DTOs.UsuarioDTOs;
using CasosDeUso.InterfacesCU.ICUUsuario;
using ExcepcionesPropias.ExcepcionesEntidades;
using LogicaAplicacion.Mappers;
using LogicaNegocio.EntidadesNegocio;
using LogicaNegocio.InterfacesRepositorio;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Text.RegularExpressions;
using System.Threading.Tasks;

namespace LogicaAplicacion.CasosUso.CUUsuario
{
    public class CUAltaUsuario : ICUAltaUsuario
    {
        public IRepositorioUsuario RepoUsuario { get; set; }
        public IRepositorioEquipo RepoEquipo { get; set; }
        public IRepositorioRol RepoRol { get; set; }
        public CUAltaUsuario(IRepositorioUsuario repoUsuario, IRepositorioEquipo repoEquipo, IRepositorioRol reporol)
        {
            RepoUsuario = repoUsuario;
            RepoEquipo = repoEquipo;
            RepoRol = reporol;
        }

        private string Dominio = "@empresa.com";

        public void Ejecutar(AltaUsuarioDTO usuarioDTO)
        {
            //nombre y apellido en minúsculas, sin espacios al principio/fin
            string nombre = (usuarioDTO.Nombre ?? "").Trim().ToLower();
            string apellido = (usuarioDTO.Apellido ?? "").Trim().ToLower();

            //Tomo las 3 primeras letras de cada uno
            string nom3 = nombre.Length >= 3 ? nombre.Substring(0, 3) : nombre;
            string ape3 = apellido.Length >= 3 ? apellido.Substring(0, 3) : apellido;

            //Junto nombre y apellido
            string nombreyapellido = nom3 + ape3;

            // Verifico que no sea vacíos
            if (string.IsNullOrWhiteSpace(nombreyapellido))
                throw new UsuarioException("Nombre y Apellido no pueden estar vacíos para generar el email.");

            // Genero el mail
            string mail = nombreyapellido + Dominio;

            // Si ya existe, agrego 4 dígitos aleatorios
            var aleatorio = new Random();
            while (RepoUsuario.FindByMail(mail) != null)
            {
                string sufijo = aleatorio.Next(0, 10000).ToString("0000");
                mail = nombreyapellido + sufijo + Dominio;
            }
            Equipo equipo = RepoEquipo.FindById(usuarioDTO.EquipoId);
            Rol rol = RepoRol.FindById(usuarioDTO.RolId);
            // Envio al Mapper
            Usuario usu = MapperUsuario.UsuarioDTOToUsuario(usuarioDTO, mail, equipo, rol);
            RepoUsuario.Add(usu);
        }
    }
}

***********************************
Archivo: CUBuscarUsuarioLogin.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\LogicaAplicacion\CasosUso\CUUsuario\CUBuscarUsuarioLogin.cs
***********************************
using CasosDeUso.DTOs.UsuarioDTOs;
using CasosDeUso.InterfacesCU.ICUUsuario;
using ExcepcionesPropias.ExcepcionesEntidades;
using LogicaAplicacion.Mappers;
using LogicaNegocio.EntidadesNegocio;
using LogicaNegocio.InterfacesRepositorio;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace LogicaAplicacion.CasosUso.CUUsuario
{
    public class CUBuscarUsuarioLogin: ICUBuscarUsuario
    {
        public IRepositorioUsuario RepoUsuario { get; set; }
        public IRepositorioRol RepoRol { get; set; }
        public CUBuscarUsuarioLogin(IRepositorioUsuario repoUsuario, IRepositorioRol repoRol)
        {
            RepoUsuario = repoUsuario;
            RepoRol = repoRol;
        }

        public DetalleLoginUsuarioDTO Ejecutar(UsuarioLoginDTO usuarioLoginDTO)
        {
            Usuario usuario = RepoUsuario.UsuarioPorMailYPass(usuarioLoginDTO.Mail, usuarioLoginDTO.Password);
            if (usuario != null)
            {
                Rol rol = RepoRol.FindById(usuario.Rol.Id);
                return MapperUsuario.UsuarioLoginDTOToUsuarioLogin(usuario);
            }
            else
            {
                throw new UsuarioException("Usuario o Contraseña incorrecto");
            }
            
        }

       
    }
}

***********************************
Archivo: CUListadoUsuario.cs
Carpeta: C:\Users\gusta\Documents\ORT_2025\P3_Liliana_Pino_2025\Obligatorio\Obligatorio-193244-P3-Gustavo-Gonzalez\LogicaAplicacion\CasosUso\CUUsuario\CUListadoUsuario.cs
***********************************
using CasosDeUso.DTOs.UsuarioDTOs;
using CasosDeUso.InterfacesCU.ICUUsuario;
using LogicaAplicacion.Mappers;
using LogicaNegocio.EntidadesNegocio;
using LogicaNegocio.InterfacesRepositorio;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace LogicaAplicacion.CasosUso.CUUsuario
{
    public class CUListadoUsuario:ICUListadoUsuarios
    {
        public IRepositorioUsuario RepoUsuario { get; set; }
        public CUListadoUsuario(IRepositorioUsuario repoUsuario)
        {
            RepoUsuario = repoUsuario;
        }

        public IEnumerable<ListadoUsuarioDTO> Ejecutar()
        {
            IEnumerable<Usuario> usuarios = RepoUsuario.FindAll();
            return MapperUsuario.ListUsuarioToListUsusarioDTO(usuarios);
        }

    }
}
